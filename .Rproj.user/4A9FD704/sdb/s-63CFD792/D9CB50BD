{
    "collab_server" : "",
    "contents" : "# NHLD model summary; JAZ 2017-03-26 \n\nrm(list=ls())\nlibrary(LSD)\nlibrary(maptools)\nlibrary(Hmisc)\n\ndir<-'D:/Jake/My Papers/NHLD Carbon Model/Results/20170818/'\nfiles=list.files(dir)\n# files=files[780:801]\nskip=6*365 # days to skip \n\nsum<-data.frame() # only open ice  \nall<-data.frame()\nval<-data.frame()\nfor(i in 1:length(files)){\n  cur<-read.table(file.path(dir,files[i]),stringsAsFactors = F,sep='\\t',header=T)\n  lake<-strsplit(files[i],'_C_model.txt',fixed = T)[[1]]\n  cur<-na.omit(cur)\n  if(length(cur$time)<2){\n    next\n  }\n  curVal=cur[skip:nrow(cur),]\n  curVal=curVal[curVal$LakeE>0&as.Date(curVal$datetime)>as.Date('2004-01-01')&as.Date(curVal$datetime)<as.Date('2004-12-31'),]\n  curVal=curVal[,3:ncol(curVal)]\n  cur<-cur[skip:(nrow(cur)-0),3:ncol(cur)] # skipping first X number of days \n  cur<-cur[cur$Vol>0,] # only keeping days when there's actually water \n  curSum=cur[cur$LakeE>0,] # only open ice periods\n \n  cur<-data.frame(t(apply(cur,MARGIN = 2,FUN = mean)))\n  curSum<-data.frame(t(apply(curSum,MARGIN = 2,FUN = mean)))\n  curVal<-data.frame(t(apply(curVal,MARGIN = 2,FUN=mean)))\n  cur$Permanent_<-lake\n  curSum$Permanent_<-lake\n  curVal$Permanent_<-lake\n  \n  sum<-rbind(sum,curSum)\n  all<-rbind(all,cur)\n  val<-rbind(val,curVal)\n}\n\nsum2=sum\n\n# \nload('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/R Data/LakeCsummary_20170828.RData')\n\nwatersheds<-read.table('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Data/C model forcing data/NHLDsheds_20170323.txt',\n                       stringsAsFactors = F,header=T,sep = '\\t')\n\nsum=merge(sum,watersheds,by='Permanent_')\nall=merge(all,watersheds,by='Permanent_')\n\nall$alk<-ifelse(all$GWin+all$Baseflow>0,10^(3.2815*(1-exp(-1.2765*log10(all$GWin+all$Baseflow+all$SWin)/3.2815))),0)\nall<-all[sort.list(all$Permanent_),]\nsum<-sum[sort.list(sum$Permanent_),]\nsum$alk<-all$alk\n# sum$streamDOC=exp(1.3961+3.245*(sum$percentWetland))/12*1000/1000\t# from lottig 2012; mol m-3\n# sum$gwDOC=13/12*1000/1000#median(ntlGW$doc,na.rm=TRUE)/12*1000/1000\t# mol m-3\n# sum$precipDOC=3.195/12*1000/1000\t\t#mol m-3; from UNDERC rain data; also see Likens et al. 1983 @ Hubbard Brook 1.1 mg L-1 \n# sum$snowDOC=0.6/12*1000/1000 # snow DOC from UNDERC snow; 0.5985 mg C L-1 to mol C m-3; snow DOC from Sebestyen lab\n\n# sum$DOCLoad=sum$SWin*sum$streamDOC+sum$Baseflow*sum$streamDOC+sum$GWin*sum$gwDOC+sum$DirectP*sum$precipDOC # mol C day-1\n# sum$DOCLoad=sum$DOCLoad*12*1000 # mg C day-1 \n# sum$emergent_d20=sum$DOCl_epi/(sum$DOCl_epi+sum$DOCr_epi)*0.08+sum$DOCr_epi/(sum$DOCl_epi+sum$DOCr_epi)*0.002\nsum$HRT<-sum$Vol/(sum$GWin+sum$SWin+sum$DirectP+sum$Baseflow+sum$IceMelt)\nsum$HRT_woEvap=sum$Vol/(sum$GWout+sum$SWout)\nall$HRT<-all$Vol/(all$GWin+all$SWin+all$DirectP+all$Baseflow+all$IceMelt)\nall$HRT_woEvap=all$Vol/(all$GWout+all$SWout)\n# sum$DOCRespired=sum$emergent_d20/(sum$emergent_d20+(1/sum$HRT)) # Brett's way of calculating Frac Retained \n# sum$DOCRespired_Evap=sum$emergent_d20/(sum$emergent_d20+(1/sum$HRT_woEvap))\n# sum$FracRet=sum$DOC_Respired/sum$DOC_Load # DOC respired includes phyto exude \n# sum$DOC_Respired_woExude=sum$DOC_Respired-(sum$GPP*sum$Vepi*0.07*0.08)-sum$GPP*sum$Vepi*0.07*0.002\n# sum$FracRet_woExude=sum$DOC_Respired_woExude/sum$DOC_Load\nsum$FracRet=1-(sum$DOC_export/sum$DOC_Load)\nall$FracRet=1-(all$DOC_export/all$DOC_Load)\n\nsum$DIC_load=sum$GWin*0.7025+sum$SWin*0.9041667+sum$Baseflow*0.9041667+sum$DirectP*0.0833333+sum$IceMelt*0.01360082 # mol C day-1 \nall$DIC_load=all$GWin*0.7025+all$SWin*0.9041667+all$Baseflow*0.9041667+all$DirectP*0.0833333+all$IceMelt*0.01360082 # mol C day-1 \n\n# fraction of DOC to DIC load \nall$DOC_to_DIC_load=all$DOC_Load/all$DIC_load\nhist(all$DOC_to_DIC_load)\nsummary(all$DOC_to_DIC_load)\n\nsum(all$DOC_Load)/sum(all$DIC_load)\nsum(all$DOC_export)/sum(all$DIC_export)\n\nsum$sed_resp<-sum$Sed_phyto*0.75+sum$Sed_tPOC*0.1 # 75% of phyto C and 10% of tpoc C was converted to co2 \nall$sed_resp<-all$Sed_phyto*0.75+all$Sed_tPOC*0.1 # 75% of phyto C and 10% of tpoc C was converted to co2 \n\nsum$waterIn=sum$GWin+sum$SWin+sum$DirectP+sum$Baseflow+sum$IceMelt\nall$waterIn=all$GWin+all$SWin+all$DirectP+all$Baseflow+all$IceMelt\n\nsum$fluvialOut=sum$GWout+sum$SWout # m3 day-1\nall$fluvialOut=all$GWout+all$SWout \n\n# DIC export (update to calculate in model, this is approximated for right now)\nsum$DIC_export=(sum$DIC_epi+sum$DIC_hypo)/sum$Vol*sum$fluvialOut # mol C day-1\nall$DIC_export=(all$DIC_epi+all$DIC_hypo)/all$Vol*all$fluvialOut # mol C day-1 \n\n# fraction of DOC to DIC fluvial export\nall$DOC_to_DIC_export=all$DOC_export/all$DIC_export\nsummary(all$DOC_to_DIC_export)\n\na=all$DOC_to_DIC_load/all$DOC_to_DIC_export\nsummary(a)\n\nsum$dicLoadvResp=sum$DIC_load/(sum$DOC_Respired+sum$sed_resp)\nall$dicLoadvResp=all$DIC_load/(all$DOC_Respired+all$sed_resp)\n\n# respiration rates etc.. based on lake size bins from Downing \nlakeSizeBins=c(0,0.01,.1,1,10,100)*1e6 # breaks for max cutoff of lake size from Downing et al. 2006\nsum$lakeSizeBins=cut(sum$Area,breaks = lakeSizeBins)\nall$lakeSizeBins=cut(all$Area,breaks=lakeSizeBins)\n\n# about a dozen lakes have negative fraction retained, cutting those out \nall<-all[all$FracRet>=0,]\nsum<-sum[sum$Permanent_%in%all$Permanent_,]\n\nwindows()\nplot(sum$FracRet~sum$HRT,ylim=c(0,1))\n# points(sum$FracRet_woExude~sum$HRT,col='red')\nplot(sum$FracRet~log10(sum$HRT),ylim=c(0,1))\nplot(all$FracRet~all$HRT,ylim=c(0,1))\n\nwindows()\nplot(log10(sum$DOC_Load)~sum$HRT)\n\n# sum$DOC_conc=(sum$DOCr_epi+sum$DOCl_epi+sum$DOCl_hypo+sum$DOCr_hypo)/(sum$Vepi+sum$Vhypo)*12\n\nlitFracRet<-read.csv('/Users/Jake/Documents/Jake/Conferences/2015/Gordon Research Conference/GRC/DrainageVseepage_Cretention.csv',\n                     stringsAsFactor=F)\nsum$percentEvap<-sum$LakeE/(sum$LakeE+sum$GWout+sum$SWout)\nall$percentEvap<-all$LakeE/(all$LakeE+all$GWout+all$SWout)\n\nwindows()\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig3_fracRet_HRT.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\n# heatscatter(log10(sum$HRT),sum$FracRet,pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,ylim=c(0,1),\n            # ylab='Fraction Retained',xlab='HRT',xaxt='n')\nheatscatter(log10(all$HRT),all$FracRet,pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,ylim=c(0,1),\n            ylab='Fraction Retained',xlab='HRT (days)',xaxt='n')\naxis(1,at = c(log10(0.10),log10(1),log10(10),log10(100),log10(1000)),labels = c(0.1,1,10,100,1000),cex.axis=cex.axis)\npoints(log10(litFracRet$HRT_yrs[litFracRet$LakeType=='Drainage']*365),\n       litFracRet$C_ret_proportion[litFracRet$LakeType=='Drainage'],pch=19,col='blue',cex=cex)\npoints(log10(litFracRet$HRT_yrs[litFracRet$LakeType=='Seepage'|litFracRet$LakeType=='UNDERC_Long']*365),\n       litFracRet$C_ret_proportion[litFracRet$LakeType=='Seepage'|litFracRet$LakeType=='UNDERC_Long'],pch=19,col='red',cex=cex)\nlegend('topleft',legend = c('Modeled','Literature Drainage','Literature Seepage'),\n      col=c('grey 40','blue','red'),bty = 'n',pch = 19,cex = 1.5,pt.cex = 2)\ndev.off()\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig3_DOCrespired_HRT.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(log10(all$HRT),log10(all$DOC_Respired/all$Area*12*365),pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,xaxt='n',\n            xlab='HRT (days)',ylab='DOC Respired (g C m-2 yr-1)',yaxt='n')\naxis(2,at = c(log10(0.10),log10(1),log10(10),log10(100),log10(1000)),labels = c(0.1,1,10,100,1000),cex.axis=cex.axis)\naxis(1,at = c(log10(0.10),log10(1),log10(10),log10(100),log10(1000)),labels = c(0.1,1,10,100,1000),cex.axis=cex.axis)\ndev.off()\n\n\n# windows()\n# par(mar=c(6,6,5,2))\n# cex.axis=3\n# cex.lab=3\n# cex=2\n# col=colorpalette(c('grey70','black'))\n# heatscatter(sum$percentEvap,sum$FracRet,pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,ylim=c(0,1),\n#             ylab='Fraction Retained',xlab='Fraction Evap')\n# \n# windows()\n# par(mar=c(6,6,5,2))\n# cex.axis=3\n# cex.lab=3\n# cex=2\n# col=colorpalette(c('grey70','black'))\n# heatscatter(sum$percentEvap,log10(sum$DOC_Respired/sum$Area*12*1000),pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,\n#             ylab='Fraction Retained',xlab='Fraction Evap')\n\n\nwindows()\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig3_d_HRT.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(log10(all$HRT),all$emergent_d_epi,pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,\n            ylab='Turnover Rate (day-1)',xlab='HRT (days)',xaxt='n')\naxis(1,at = c(log10(0.10),log10(1),log10(10),log10(100),log10(1000)),labels = c(0.1,1,10,100,1000),cex.axis=cex.axis)\ndev.off()\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig3_d_fracEvap.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(log10(all$percentEvap),all$emergent_d_epi,pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,\n            ylab='Turnover Rate (day-1)',xlab='Fraction Export as Evap')\ndev.off()\nsummary(lm(all$emergent_d_epi~log10(all$percentEvap)+all$meanDepth))\nres=resid(lm(all$emergent_d_epi~log10(all$percentEvap)))\nplot(res~all$meanDepth)\nsummary(lm(res~all$meanDepth))\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig3_d_HRT_logged.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(log(all$HRT/365),log(all$emergent_d_epi*365),pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,\n            ylab='log[Turnover Rate (yr-1)]',xlab='log[HRT (years)]',xaxt='n',yaxt='n')\naxis(1,at = c(log(.01),log(0.10),log(1),log(5)),labels = c(.01,0.1,1,5),cex.axis=cex.axis)\naxis(2,at = c(log(.01),log(0.50),log(1),log(2)),labels = c(.01,0.5,1,2),cex.axis=cex.axis)\nabline(lm(log(all$emergent_d_epi*365)~log(all$HRT/365)))\nsummary(lm(log(all$emergent_d_epi[all$HRT>10]*365)~log(all$HRT[all$HRT>10]/365)))\nabline(lm(log(all$emergent_d_epi[all$HRT>10]*365)~log(all$HRT[all$HRT>10]/365)))\ndev.off()\n\nheatscatter(log(all$HRT_woEvap/365),log(all$emergent_d_epi*365),pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,\n            ylab='log[Turnover Rate (yr-1)]',xlab='log[HRT (years)]',xaxt='n',yaxt='n')\naxis(1,at = c(log(.01),log(0.10),log(1),log(5)),labels = c(.01,0.1,1,5),cex.axis=cex.axis)\naxis(2,at = c(log(.01),log(0.50),log(1),log(2)),labels = c(.01,0.5,1,2),cex.axis=cex.axis)\nsummary(lm(log(all$emergent_d_epi*365)~log(all$HRT_woEvap/365)))\n\ndillon=data.frame(meanDepth=c(8.5,8.9,9.2,5,13.3,7.9,14.2),runoff=c(1.5,4.23,5.6,2.66,4.16,2.00,5.44),\n                  WALA=c(105.9/52.35,271.8/34.41,521.8/56.74,406.4/93.60,470.7/71.38,95.5/32.14,532.4/57.13),\n                  ret=c(.59,.42,.37,.55,.42,.69,.37),settle=c(2.2,3,3.3,3.2,2.9,4.6,3.2))\ndillon$modeledRet=(dillon$settle/dillon$meanDepth/365)/((dillon$settle/dillon$meanDepth/365)+dillon$runoff/365/dillon$meanDepth)\nplot(dillon$ret~dillon$modeledRet)\nabline(0,1)\n\n# see notebook for derivation \nall$emergent_d_all=(all$emergent_d_epi*all$Vepi+all$emergent_d_hypo*all$Vhypo)/(all$Vepi+all$Vhypo)\nfracRet=all$emergent_d_all/(all$emergent_d_all+(all$LakeE/all$Area/all$percentEvap-all$LakeE/all$Area)/(all$Vol/all$Area))\n\nfracRet=mean(all$emergent_d_all)/(mean(all$emergent_d_all)+(all$LakeE/all$Area/all$percentEvap-all$LakeE/all$Area)/(all$Vol/all$Area))\n\nplot(fracRet~all$FracRet)\nabline(0,1,lwd=2,col='red')\nabline(lm(fracRet~all$FracRet))\nsummary(lm(fracRet~all$FracRet))\n\n# derivation including shape and rate parameters from Vachon et al. 2016. v is about 0.12, which makes alpha about 13.33 \nv=.62\nalpha=108\ndecay=(0.85*v)/(all$meanDepth/(all$LakeE/all$Area/all$percentEvap-all$LakeE/all$Area))*\n  log(1+(all$meanDepth/(all$LakeE/all$Area/all$percentEvap-all$LakeE/all$Area))/alpha)\n\nfracRet=decay/(decay+(all$LakeE/all$Area/all$percentEvap-all$LakeE/all$Area)/(all$Vol/all$Area))\n\nfracRet=0.85*v*log(1+(all$meanDepth/(all$LakeE/all$Area/all$percentEvap-all$LakeE/all$Area))/alpha)/\n  (0.85*v*log(1+(all$meanDepth/(all$LakeE/all$Area/all$percentEvap-all$LakeE/all$Area))/alpha)+1)\n\nplot(fracRet~all$FracRet,ylim=c(0,1),xlim=c(0,1))\nabline(0,1)\n\nlibrary(scales)\ngamma_est<-function(p,x){\n  -sum(dgamma(x,shape=exp(p[1]),scale=exp(p[2]),log=TRUE))\n}\n\nguess=log(c(1.052,100))\nxout=seq(0.00001,.1,length.out = 100)\n\ninitialReactivity=c(rep(0.0015,9),rep(0.08,1))\npar=exp(optim(guess,gamma_est,x=initialReactivity)$par)\nout=dgamma(xout,shape=par[1],scale=par[2])\nout=out/max(out)\n\nwindows()\nplot(xout,out,type='l')\n\nv=par[2] # shape \nalpha=par[1] # rate \n\nalpha=12.5 # average lifetime of most reactivit compounds in days \nv=.9 # relative abundance of the most recalcitrant compounds \n\nfracRet=0.85*v*log(1+(all$meanDepth/(all$LakeE/all$Area/all$percentEvap-all$LakeE/all$Area))/alpha)/\n  (0.85*v*log(1+(all$meanDepth/(all$LakeE/all$Area/all$percentEvap-all$LakeE/all$Area))/alpha)+1)\n\nfracRet=0.85*v*log(1+(all$meanDepth/(all$LakeE/all$Area/all$percentEvap-all$LakeE/all$Area))/alpha)/\n  (0.85*v*log(1+(all$meanDepth/(all$LakeE/all$Area/all$percentEvap-all$LakeE/all$Area))/alpha)+1)\n\nplot(fracRet~all$FracRet,ylim=c(0,1),xlim=c(0,1))\nabline(0,1)\n\n\nwindows()\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig3_fracRet_RespRate.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(all$FracRet,log10(all$DOC_Respired/all$Area*12*365),pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,xlim=c(0,1),\n            xlab='Fraction Retained',ylab='DOC Respired (g C m-2 yr-1)',yaxt='n')\naxis(2,at = c(log10(0.10),log10(1),log10(10),log10(100),log10(1000)),labels = c(0.1,1,10,100,1000),cex.axis=cex.axis)\ndev.off()\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig3_fracRet_fracEvap.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(all$percentEvap,all$FracRet,pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,xlim=c(0,1),\n            xlab='Fraction Export as Evap',ylab='Fraction Retained')\nabline(0,1)\nabline(lm(all$FracRet~all$percentEvap))\nall$meanDepth=all$Vol/all$Area\nsummary(lm(all$FracRet~all$percentEvap))\nsummary(lm(all$FracRet~all$percentEvap+all$meanDepth))\nsummary(lm(all$FracRet~all$percentEvap+all$emergent_d_all))\n\n\nsummary(lm(all$FracRet~all$percentEvap*all$meanDepth))\nsummary(lm(all$FracRet~(all$percentEvap/all$meanDepth)))\nres=resid(lm(all$FracRet~all$percentEvap))\nplot(res~all$meanDepth)\nabline(lm(res~all$meanDepth))\nsummary(lm(res~all$meanDepth))\ndev.off()\n\nfit=nls(FracRet~a*exp(percentEvap)+b,data = all,algorithm = 'port',\n        start = c(b=.03,a=-1),lower=c(b=-Inf,a=-Inf),upper=c(b=Inf,a=Inf))\nsummary(fit)\nall$predFracRet=predict(fit)\nplot(all$FracRet~all$percentEvap,pch=16,cex=2)\ntemp=all[sort.list(all$predFracRet),]\nlines(temp$predFracRet~temp$percentEvap,col='red')\nabline(0,1,col='red',lty=2,lwd=2)\n\nsummary(lm(all$FracRet~all$percentEvap))\n\n\n\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig3_emit_fracEvap.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(all$percentEvap,log10(all$Emit/all$Area*12*365),pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,xlim=c(0,1),\n            xlab='Fraction Export as Evap',ylab='Emissions (g C m-2 yr-1)',yaxt='n',ylim=c(log10(3),log10(1000)))\naxis(2,at = c(log10(1),log10(10),log10(100),log10(1000)),labels = c(1,10,100,1000),cex.axis=cex.axis)\ndev.off()\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig3_emit_NEP.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(sum$NEP/sum$Area*12*1000,log10(all$Emit/all$Area*12*365),pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,\n            xlab='Fraction Export as Evap',ylab='Emissions (g C m-2 yr-1)',yaxt='n',ylim=c(log10(3),log10(1000)))\naxis(2,at = c(log10(1),log10(10),log10(100),log10(1000)),labels = c(1,10,100,1000),cex.axis=cex.axis)\ndev.off()\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig3_burial_fracEvap.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(all$percentEvap,log10((all$Burial_tPOC+all$Burial_phyto)/all$Area*12*365),pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,xlim=c(0,1),\n            xlab='Fraction Export as Evap',ylab='Burial (g C m-2 yr-1)',yaxt='n',ylim=c(log10(.5),log10(100)))\naxis(2,at = c(log10(1),log10(10),log10(100),log10(1000)),labels = c(1,10,100,1000),cex.axis=cex.axis)\ndev.off()\n\nsummary(lm(log10((all$Burial_tPOC+all$Burial_phyto)/all$Area*12*365)~all$percentEvap+all$meanDepth))\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig3_dicLoad_RespRate.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(log10(all$DIC_load/all$Area*12*365),log10(all$DOC_Respired/all$Area*12*365),pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,\n            xlab='DIC Load (g C m-2 yr-1)',ylab='DOC Respired (g C m-2 yr-1)',yaxt='n',xaxt='n',ylim=c(0,log10(1000)),xlim=c(0,log10(50000)))\naxis(2,at = c(log10(0.10),log10(1),log10(10),log10(100),log10(1000)),labels = c(0.1,1,10,100,1000),cex.axis=cex.axis)\naxis(1,at = c(log10(0.10),log10(1),log10(10),log10(100),log10(1000),log10(10000)),labels = c(0.1,1,10,100,1000,10000),cex.axis=cex.axis)\nabline(0,1,lty=2,lwd=2)\ndev.off()\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig3_dictoResp_fracEvap.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(all$percentEvap,log10(all$dicLoadvResp),pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,\n            xlab='Fraction Export as Evap',ylab='DIC Load : DIC Produced',yaxt='n')\naxis(2,at = c(log10(0.10),log10(1),log10(10),log10(100),log10(1000),log10(10000)),labels = c(0.1,1,10,100,1000,10000),cex.axis=cex.axis)\nabline(h=log10(1),lty=2,lwd=2)\ndev.off()\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig3_dictoResp_emit.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(log10(all$Emit/all$Area*12*365),log10(all$dicLoadvResp),pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,\n            xlab='Emissions (g C m-2 yr-1)',ylab='DIC Load : DIC Produced',yaxt='n',xaxt='n',xlim=c(log10(3),log10(1000)))\naxis(2,at = c(log10(0.10),log10(1),log10(10),log10(100),log10(1000),log10(10000)),labels = c(0.1,1,10,100,1000,10000),cex.axis=cex.axis)\naxis(1,at = c(log10(0.10),log10(1),log10(10),log10(100),log10(1000),log10(10000)),labels = c(0.1,1,10,100,1000,10000),cex.axis=cex.axis)\nabline(h=log10(1),lty=2,lwd=2)\npoints(log10(all$Emit[sum$NEP>0]/all$Area[sum$NEP>0]*12*365),log10(all$dicLoadvResp[sum$NEP>0]),col='green',cex=cex,\n       pch=16)\nlegend('topleft',legend = c('Heterotrophic','Autotrophic'),\n       col=c('grey 40','green'),bty = 'n',pch = 19,cex = 1.5,pt.cex = 2)\ndev.off()\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig3_dictoResp_emitTotal.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(log10(all$Emit*12*365),log10(all$dicLoadvResp),pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,\n            xlab='Emissions (g C yr-1)',ylab='DIC Load : DOC Respired',yaxt='n',xaxt='n')\naxis(2,at = c(log10(0.10),log10(1),log10(10),log10(100),log10(1000),log10(10000)),labels = c(0.1,1,10,100,1000,10000),cex.axis=cex.axis)\naxis(1,at = c(log10(1e4),log10(1e6),log10(1e8)),labels = c(1e4,1e6,1e8),cex.axis=cex.axis)\nabline(h=log10(1),lty=2,lwd=2)\npoints(log10(all$Emit[sum$NEP>0]*12*365),log10(all$dicLoadvResp[sum$NEP>0]),col='green',cex=cex,\n       pch=16)\ndev.off()\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig3_dictoResp_Area.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(log10(all$Area),log10(all$dicLoadvResp),pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,\n            xlab='Area (m-2)',ylab='DIC Load : DOC Respired',yaxt='n',xaxt='n')\naxis(2,at = c(log10(0.10),log10(1),log10(10),log10(100),log10(1000),log10(10000)),labels = c(0.1,1,10,100,1000,10000),cex.axis=cex.axis)\naxis(1,at = c(log10(1e4),log10(1e6),log10(1e8)),labels = c(1e4,1e6,1e8),cex.axis=cex.axis)\nabline(h=log10(1),lty=2,lwd=2)\npoints(log10(all$Area[sum$NEP>0]),log10(all$dicLoadvResp[sum$NEP>0]),col='green',cex=cex,\n       pch=16)\ndev.off()\n\nwindows()\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig5_Burial_HRT.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(log10(all$HRT),log10((all$Burial_tPOC+all$Burial_phyto)/all$Area*12*365),pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,\n            xlab='HRT (days)',ylab='Sed Burial (g C m-2 yr-1)',yaxt='n',xaxt='n',ylim=c(log10(0.5),log10(100)))\naxis(2,at = c(log10(0.10),log10(1),log10(10),log10(100),log10(1000)),labels = c(0.1,1,10,100,1000),cex.axis=cex.axis)\naxis(1,at = c(log10(0.10),log10(1),log10(10),log10(100),log10(1000)),labels = c(0.1,1,10,100,1000),cex.axis=cex.axis)\ndev.off()\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig5_Burial_TP.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(log10((all$P_epi+all$phyto/95)/all$Vepi*1000*31),log10((all$Burial_tPOC+all$Burial_phyto)/all$Area*12*365),pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,\n            xlab='TP ug L-1',ylab='Sed Burial (g C m-2 yr-1)',yaxt='n',xaxt='n',xlim=c(log10(0.5),log10(100)),ylim=c(log10(0.5),log10(100)))\naxis(2,at = c(log10(0.10),log10(1),log10(10),log10(100),log10(1000)),labels = c(0.1,1,10,100,1000),cex.axis=cex.axis)\naxis(1,at = c(log10(0.10),log10(1),log10(10),log10(100),log10(1000)),labels = c(0.1,1,10,100,1000),cex.axis=cex.axis)\ndev.off()\n\n\nwindows()\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig6_Emit_Area.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(log10(all$Area),log10(all$Emit/all$Area*12*365),pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,\n            xlab='Lake Area (m2)',ylab='Emissions (g C m-2 yr-1)',yaxt='n',xaxt='n',ylim=c(log10(3),log10(1000)))\naxis(2,at = c(log10(1),log10(10),log10(100),log10(1000)),labels = c(1,10,100,1000),cex.axis=cex.axis)\naxis(1,at = c(log10(100),log10(10000),log10(1000000)),labels = c(100,10000,1000000),cex.axis=cex.axis)\ndev.off()\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig6_Burial_Area.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(log10(all$Area),log10((all$Burial_tPOC+all$Burial_phyto)/all$Area*12*365),pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,\n            xlab='Lake Area (m2)',ylab='Burial (g C m-2 yr-1)',yaxt='n',xaxt='n',ylim=c(log10(.5),log10(100)))\naxis(2,at = c(log10(1),log10(10),log10(100),log10(1000)),labels = c(1,10,100,1000),cex.axis=cex.axis)\naxis(1,at = c(log10(100),log10(10000),log10(1000000)),labels = c(100,10000,1000000),cex.axis=cex.axis)\ndev.off()\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig6_WALA_Area.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(log10(all$Area),log10(all$WALA),pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,\n            xlab='Lake Area (m2)',ylab='WA:LA',yaxt='n',xaxt='n')\naxis(2,at = c(log10(1),log10(10),log10(100),log10(1000),log10(10000)),labels = c(1,10,100,1000,10000),cex.axis=cex.axis)\naxis(1,at = c(log10(100),log10(10000),log10(1000000)),labels = c(100,10000,1000000),cex.axis=cex.axis)\ndev.off()\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig6_HRT_Area.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(log10(all$Area),all$HRT/365,pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,\n            xlab='Lake Area (m2)',ylab='HRT (years)',xaxt='n')\n# axis(2,at = c(log10(1),log10(10),log10(100),log10(1000),log10(10000)),labels = c(1,10,100,1000,10000),cex.axis=cex.axis)\naxis(1,at = c(log10(100),log10(10000),log10(1000000)),labels = c(100,10000,1000000),cex.axis=cex.axis)\ndev.off()\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig6_FracEvap_Area.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(log10(all$Area),all$percentEvap,pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,\n            xlab='Lake Area (m2)',ylab='Fraction Export as Evap',xaxt='n')\n# axis(2,at = c(log10(1),log10(10),log10(100),log10(1000),log10(10000)),labels = c(1,10,100,1000,10000),cex.axis=cex.axis)\naxis(1,at = c(log10(100),log10(10000),log10(1000000)),labels = c(100,10000,1000000),cex.axis=cex.axis)\ndev.off()\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/Fig6_d_Area.png',width = 7,\n    height=7,units = 'in',res = 300)\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\ncol=colorpalette(c('grey70','black'))\nheatscatter(log10(all$Area),all$emergent_d_epi,pch = 19,colpal = col,cex=cex,main='',cex.axis=cex.axis,cex.lab=cex.lab,\n            xlab='Lake Area (m2)',ylab='Turnover Rate DOC (day-1)',xaxt='n')\n# axis(2,at = c(log10(1),log10(10),log10(100),log10(1000),log10(10000)),labels = c(1,10,100,1000,10000),cex.axis=cex.axis)\naxis(1,at = c(log10(100),log10(10000),log10(1000000)),labels = c(100,10000,1000000),cex.axis=cex.axis)\ndev.off()\n\n\nplot(all$percentEvap~all$HRT)\n\nplot(all$percentEvap,all$HRT*all$LakeE/all$Area/all$meanDepth)\n\n\n\nwindows()\nboxplot(sum$Emit/sum$Area*12*365~sum$lakeSizeBins,outline=T)\nboxplot((sum$Burial_tPOC+sum$Burial_phyto)/sum$Area*12*365~sum$lakeSizeBins,outline=T)\nboxplot(sum$FracRet[sum$FracRet>0]~sum$lakeSizeBins[sum$FracRet>0],outline=F)\n\nboxplot(all$Emit/all$Area*12*365~all$lakeSizeBins,outline=T)\nboxplot((all$Burial_tPOC+all$Burial_phyto)/all$Area*12*365~all$lakeSizeBins,outline=T)\nboxplot(all$FracRet[all$FracRet>0]~all$lakeSizeBins[all$FracRet>0],outline=F)\nboxplot(all$percentEvap[all$FracRet>0]~all$lakeSizeBins[all$FracRet>0],outline=F)\n\nsummary(sum$Emit/sum$Area*12*365~sum$lakeSizeBins) # g C m-2 yr-1 \nsummary(all$Emit/all$Area*12*365~all$lakeSizeBins)\n\nall$allBurial=all$Burial_tPOC+all$Burial_phyto\nsum$allBurial=sum$Burial_tPOC+sum$Burial_phyto\nsummary(all$allBurial/all$Area*12*365~all$lakeSizeBins)\nsummary(sum$allBurial/sum$Area*12*365~sum$lakeSizeBins)\n\nsummary(all$FracRet~all$lakeSizeBins)\n\nsummary(all$HRT~all$lakeSizeBins)\n\nsummary(sum$emergent_d_epi~sum$lakeSizeBins)\n\nsum(sum$k*sum$Area)/sum(sum$Area)\n\nsum(sum$pH*sum$Area)/sum(sum$Area)\n\nsum(.952*sum$fracCO2*sum$DIC_epi/sum$Vepi*1000*29.41*sum$Area)/sum(sum$Area)\n\nsum(all$allBurial*12*365)/sum(all$Area)\nsum(sum$allBurial*12*365)/sum(sum$Area)\n\nsum(all$Emit*12*365)/sum(all$Area)\n\nsum(sum$Emit*12*365)/sum(sum$Area)\n\nsum(all$FracRet*all$Area)/sum(all$Area)\n\nsum(all$HRT*all$Area)/sum(all$Area)\n\nsum(sum$emergent_d_epi*sum$Area)/sum(sum$Area)\n\nsum(all$emergent_d_epi*all$Area)/sum(all$Area)\n\nall$allDOC<-all$DOCr_epi+all$DOCl_epi\nsummary(all$allDOC/all$Vepi*12~all$lakeSizeBins)\n\nboxplot(sum$DOCr_epi/sum$Vepi*12~sum$lakeSizeBins,outline=T)\n\nboxplot(sum$DIC_epi/sum$Vepi*12~sum$lakeSizeBins,outline=T)\n\nsummary(all$dicLoadvResp)\n\nsummary(all$dicLoadvResp~all$lakeSizeBins)\n\nsummary(all$percentEvap~all$lakeSizeBins)\n\nsum(all$percentEvap*all$Area)/sum(all$Area)\n\nanova(lm(all$dicLoadvResp~all$lakeSizeBins))\n\nanova(lm(all$HRT~all$lakeSizeBins))\nsummary(lm(all$HRT~log10(all$Area)))\n\nsummary(lm(all$waterIn/all$Area~log10(all$Area)))\nsummary(lm(log10(all$Vol)~log10(all$Area)))\nsummary(lm(all$percentEvap~log10(all$Area)))\n\nanova(lm(all$FracRet~all$lakeSizeBins))\n\nanova(lm(all$WALA~all$lakeSizeBins))\nboxplot(all$WALA~all$lakeSizeBins,outline=F)\nplot(log10(all$WALA)~log10(all$Area))\nsummary(lm(log10(all$WALA)~log10(all$Area)))\n\nsummary(lm(all$emergent_d_epi~log10(all$Area)))\n\nanova(lm(all$percentEvap~all$lakeSizeBins))\n\nanova(lm(all$Emit/all$Area~all$lakeSizeBins))\n\nboxplot(all$Emit/all$Area~all$lakeSizeBins)\n\nanova(lm(all$k~all$lakeSizeBins))\n\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/fig8_fracEmitBury_fracLakes.png',width = 14,height = 7,res=300,units='in')\npar(mar=c(6,6,5,2),mfrow=c(1,2))\ncex.axis=2.5\ncex.lab=2.5\nlwd=8\npch=16\ncex=2\ntemp=all[sort.list(all$Emit),]\ntemp$i=seq(1,nrow(temp),1)/nrow(temp)\ntemp$EmitFrac=temp$Emit/sum(temp$Emit)\ntemp$EmitFrac=cumsum(temp$EmitFrac)\nplot(temp$i~temp$EmitFrac,cex=cex,pch=pch,lwd=lwd,xlab='Fraction of Total Emissions',ylab='Cumulative Fraction',cex.lab=cex.lab,cex.axis=cex.axis)\nv=0.1\nh=temp$i[min(which(temp$EmitFrac>v))] # fraction of lakes for which 90% of emissions are accounted for  \nabline(h=h,lty=2,lwd=3)\nabline(v=v,lty=2,lwd=3)\n\ntemp=all[sort.list(all$Burial_phyto+all$Burial_tPOC),]\ntemp$i=seq(1,nrow(temp),1)/nrow(temp)\ntemp$BuryFrac=(temp$Burial_tPOC+temp$Burial_phyto)/sum(temp$Burial_tPOC+temp$Burial_phyto)\ntemp$BuryFrac=cumsum(temp$BuryFrac)\nplot(temp$i~temp$BuryFrac,cex=cex,pch=pch,lwd=lwd,xlab='Fraction of Total Burial',ylab='',cex.lab=cex.lab,cex.axis=cex.axis)\nv=0.1\nh=temp$i[min(which(temp$BuryFrac>v))] # fraction of lakes for which 90% of emissions are accounted for  \nabline(h=h,lty=2,lwd=3)\nabline(v=v,lty=2,lwd=3)\ndev.off() \n\ntemp=all[sort.list(all$Burial_phyto+all$Burial_tPOC),]\ntemp$i=seq(1,nrow(temp),1)/nrow(temp)\ntemp$BuryFrac=(temp$Burial_tPOC+temp$Burial_phyto)/sum(temp$Burial_tPOC+temp$Burial_phyto)\ntemp$BuryFrac[temp$Permanent_==ntlLookUp$Permanent_[ntlLookUp$lakeID=='TR']]\n\ntemp=all[sort.list(all$Emit),]\ntemp$i=seq(1,nrow(temp),1)/nrow(temp)\ntemp$EmitFrac=temp$Emit/sum(temp$Emit)\ntemp$EmitFrac[temp$Permanent_==ntlLookUp$Permanent_[ntlLookUp$lakeID=='TR']]\n\ntemp$Emit[temp$Permanent_==ntlLookUp$Permanent_[ntlLookUp$lakeID=='TR']]/temp$Area[temp$Permanent_==ntlLookUp$Permanent_[ntlLookUp$lakeID=='TR']]*12*365\n\n(temp$Burial_tPOC[temp$Permanent_==ntlLookUp$Permanent_[ntlLookUp$lakeID=='TR']]+temp$Burial_tPOC[temp$Permanent_==ntlLookUp$Permanent_[ntlLookUp$lakeID=='TR']])/\n  temp$Area[temp$Permanent_==ntlLookUp$Permanent_[ntlLookUp$lakeID=='TR']]*12*365\n\n\n\nsum(temp$Emit[1:37])/sum(temp$Emit)\n\n\nboxplot(all$percentEvap~all$lakeSizeBins)\n\nboxplot(all$dicLoadvResp~all$lakeSizeBins,outline=F)\n\nplot(log10(all$dicLoadvResp)~log10(all$Area))\n\nplot(log10(all$dicLoadvResp)~log10(all$Emit))\n\nboxplot(sum$fracCO2~sum$lakeSizeBins,outline=T)\n\nall$totalDICcontributed=all$DOC_Respired+all$sed_resp+all$DIC_load\nsum(all$DOC_Respired)/sum(all$totalDICcontributed)\nsum(all$DIC_load)/sum(all$totalDICcontributed)\nsum(all$sed_resp)/sum(all$totalDICcontributed)\n\nsum(all$Emit[all$dicLoadvResp>1])/sum(all$Emit)\nsum(all$Emit[all$dicLoadvResp<1])/sum(all$Emit)\n\n# open ice GPP \nsum$NEP=sum$GPP*sum$Vepi*.15-sum$DOC_Respired # mol C day-1 in NPP\nsummary(sum$NEP)\nboxplot(sum$NEP/sum$Area*12*1000,outline=F) # NEP in mg C m-2 day-1\nabline(0,0)\n\nsum$DOC_Respired_Epi=sum$emergent_d_epi*(sum$DOCr_epi+sum$DOCl_epi)\nsum$NEP=sum$GPP*sum$Vepi*.15-sum$DOC_Respired_Epi\n\nsum[sum$NEP>0,]\n\nsummary(all$Emit[sum$NEP>0]/all$Area[sum$NEP>0]*12*365) # g C m-2 yr-1 (summertime rates) \nsummary(all$Emit[sum$NEP<0]/all$Area[sum$NEP<0]*12*365) # g C m-2 yr-1 (summertime rates) \nsummary(all$Emit/all$Area*12*365)\nsum=sum[sort.list(sum$Permanent_),]\nall=all[sort.list(all$Permanent_),]\n\nhist(all$HRT)\nhist(all$HRT[sum$NEP>0],col='red',add=T)\n\nnetAutoEmit=all$Emit[sum$NEP>0]/all$Area[sum$NEP>0]*12*365 # g C m-2 yr-1 (summertime rates) \n\nhist(log10(all$Emit/all$Area*12*365))\nhist(log10(netAutoEmit),add=T,col='red')\n\ngpp=sum$GPP*sum$Vepi/sum$Area*12*1000 \n\nboxplot(sum$fracCO2*sum$DIC_epi/sum$Vepi*12~sum$lakeSizeBins,outline=T)\nsummary(sum$fracCO2*sum$DIC_epi/sum$Vepi*12~sum$lakeSizeBins)\n\nsummary(.952*sum$fracCO2*sum$DIC_epi/sum$Vepi*1000*29.41~sum$lakeSizeBins) # pCO2 \nsummary(.952*all$fracCO2*all$DIC_epi/all$Vepi*1000*29.41~all$lakeSizeBins) # pCO2 \nsummary(sum$k~sum$lakeSizeBins)\nsummary(all$k~all$lakeSizeBins)\nsummary(sum$pH~sum$lakeSizeBins)\nsummary(.952*sum$fracCO2*sum$DIC_epi/sum$Vepi*1000*29.41) # pCO2 \n\nhist(.952*sum$fracCO2*sum$DIC_epi/sum$Vepi*1000*29.41)\nhist(.952*sum$fracCO2*sum$DIC_epi/sum$Vepi*1000*29.41/390,breaks = c(-1.2,1.2,2,4,8,16,35))\n\n\n\nplot(sum$fracCO2*sum$DIC_epi/sum$Vepi*12~sum$DOC_conc)\nabline(lm(sum$fracCO2*sum$DIC_epi/sum$Vepi*12~sum$DOC_conc))\nsummary(lm(sum$fracCO2*sum$DIC_epi/sum$Vepi*12~sum$DOC_conc))\n\nplot(.952*sum$fracCO2*sum$DIC_epi/sum$Vepi*1000*29.41~sum$percentEvap)\nplot(sum$Emit/sum$Area*1000*12~sum$percentEvap)\nplot(sum$Emit/sum$Area*1000*12~sum$HRT)\nplot(sum$Emit/sum$Area*1000*12~log10(sum$Area))\nplot(sum$Emit/sum$Area*1000*12~log10(sum$WALA))\n\nsummary(sum$Emit[sum$Area<10000]/sum$Area[sum$Area<10000]*12*1000)\n\nwindows()\nplot(log10(sum$WALA)~log10(sum$Area))\n\nhanson<-read.csv('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Validation Data/NHLD Random Sampling/random_lake_survey_measured_parameters.csv',\n                 stringsAsFactor=F)\nhansonLoc<-read.csv('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Validation Data/NHLD Random Sampling/random_lake_survey_lakes.csv',\n                    stringsAsFactor=F)\nhanson<-merge(hanson,hansonLoc,by='wbic',all.x=T)\n# hanson<-hanson[hanson$doc>1&hanson$area>10000,] # keeping only greater than 1 ha for now\nwbic_perm=readShapeSpatial('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/GIS/NHLD_Lakes_NHD_WBIC_Join.shp')\nwbic_perm=data.frame(wbic_perm)\nwbic_perm=wbic_perm[,c('Permanent_','WATERBODY_')]\ncolnames(wbic_perm)[2]='wbic'\nhanson=merge(hanson,wbic_perm,by='wbic',all.x=T)\nhanson$Permanent_<-as.character(hanson$Permanent_)\n\nwindows()\nhist(sum$pH)\nhist(hanson$pH)\nhist(sum$fracCO2)\nplot(sum$pH~log10(sum$Area),ylim=range(c(hanson$pH,sum$pH),na.rm = T))\nabline(lm(sum$pH~log10(sum$Area)))\npoints(hanson$pH~log10(hanson$area),col='red',pch=16)\nabline(lm(hanson$pH~log10(hanson$area)),col='red')\n\nsummary(hanson$pH)\nsummary(sum$pH)\nboxplot(sum$pH,at = c(1),col='red',ylim=range(hanson$pH,sum$pH))\nboxplot(hanson$pH,add = T)\n\nhist(log10(0.952*sum$fracCO2*sum$DIC_epi/sum$Vepi/1000*1e6*29.41),xaxt='n') # ppm \naxis(1,c(log10(500),log10(1000),log10(5000)),c(500,1000,5000))\n\nhist(-0.5*(400-sum$fracCO2*sum$DIC_epi/sum$Vepi/1000*1e6*29.41)/sum$zmix)\n\nwindows()\nhist((sum$DOCr_epi+sum$DOCl_epi)/sum$Vepi*12)\nsummary((sum$DOCr_epi+sum$DOCl_epi)/sum$Vepi*12)\nsummary((sum$DOCr_epi+sum$DOCl_epi+sum$DOCl_hypo+sum$DOCr_hypo)/(sum$Vepi+sum$Vhypo)*12)\n\n# cumulative fraction \npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/hanson_doc_cumFreq.png',\n    width = 7,height = 7,res = 300,units = 'in')\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\nlwd=8\nsum$doc_conc<-(sum$DOCr_epi+sum$DOCl_epi+sum$DOCr_hypo+sum$DOCl_hypo)/(sum$Vol)*12\nsum<-sum[sort.list(sum$doc_conc),]\nsum$i<-seq(1,length(sum$SWin),1)\nsum$i<-sum$i/length(sum$SWin)\nhanson<-hanson[sort.list(hanson$doc),]\nhanson$i<-seq(1,length(hanson$wbic),1)/length(hanson$wbic)\ntemp=hanson[hanson$doc>0,]\ntemp=temp[sort.list(temp$doc),]\ntemp$area<-temp$area/sum(temp$area)\ntemp$area<-cumsum(temp$area)\ntempSum=sum[sort.list(sum$doc_conc),]\ntempSum$Area=tempSum$Area/sum(tempSum$Area)\ntempSum$Area=cumsum(tempSum$Area)\nplot(hanson$i[hanson$doc>0]~hanson$doc[hanson$doc>0],type='l',lwd=lwd,xlab='DOC mg L-1',cex.lab=cex.lab,\n     cex.axis=cex.axis,ylab='Cumulaive Fraction',col='grey60')\nlines(sum$i~sum$doc_conc,lwd=8)\nlines(temp$area~temp$doc,lwd=8,lty=3,col='grey60')\nlines(tempSum$Area~tempSum$doc_conc,lwd=8,lty=3)\n# axis(1,at=c(log10(5),log10(10),log10(30),log10(100)),labels=c(5,10,30,100),cex.axis=2)\nlegend('topleft',legend = c('Modeled','Random Sampling'),fill = c('black','grey60'),bty='n',cex = 1.5)\ndev.off()\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/hanson_doc_1to1.png',\n    width = 7,height = 7,res = 300,units = 'in')\ntemp=merge(hanson,sum,by='Permanent_',all.x=T)\npar(bty='l',mar=c(5,6,5,5))\nplot(temp$doc[temp$doc>0]~temp$doc_conc[temp$doc>0],pch=16,cex=2,xlim=c(0,35),ylim=c(0,35),cex.axis=2,\n     cex.lab=2,ylab='Observed (mg C L-1)',xlab='Modeled (mg C L-1)') # see Canham et al 2004 Fig. 2 \nabline(0,1,lwd=3,lty=2)\ntext(x = 30,y = 25,labels = '1:1',cex = 2)\ndev.off()\n# abline(lm(temp$doc[temp$doc>0]~temp$doc_conc[temp$doc>0]),lwd=2)\nsummary(lm(temp$doc[temp$doc>0]~temp$doc_conc[temp$doc>0]))\nsummary(hanson$doc[hanson$doc>0])\nsummary(sum$doc_conc)\n\nall$doc_conc<-(all$DOCr_epi+all$DOCl_epi+all$DOCr_hypo+all$DOCl_hypo)/(all$Vol)*12\nall<-all[sort.list(all$doc_conc),]\nall$i<-seq(1,length(all$SWin),1)\nall$i<-all$i/length(all$SWin)\nhanson<-hanson[sort.list(hanson$doc),]\nhanson$i<-seq(1,length(hanson$wbic),1)/length(hanson$wbic)\nplot(hanson$i~log10(hanson$doc),type='l',lwd=8,xlim=c(log10(2.5),log10(60)),xlab='DOC mg L-1',xaxt='n',cex.lab=1.5,\n     cex.axis=2,ylab='Cumulaive Fraction',col='grey60')\nlines(all$i~log10(all$doc_conc),lwd=8)\naxis(1,at=c(log10(5),log10(10),log10(30),log10(100)),labels=c(5,10,30,100),cex.axis=2)\nlegend('topleft',legend = c('Modeled','Random Sampling'),fill = c('black','grey60'),bty='n' )\ntemp=merge(hanson,all,by='Permanent_',all.x=T)\nplot(temp$doc[temp$doc>0]~temp$doc_conc[temp$doc>0],pch=16,cex=2,xlim=c(0,35),ylim=c(0,35),cex.axis=2,\n     cex.lab=2,ylab='Observed',xlab='Modeled') # see Canham et al 2004 Fig. 2 \nabline(0,1,lwd=2,lty=2)\nabline(lm(temp$doc[temp$doc>0]~temp$doc_conc[temp$doc>0]),lwd=2)\nsummary(lm(temp$doc[temp$doc>0]~temp$doc_conc[temp$doc>0]))\nsummary(hanson$doc[hanson$doc>0])\nsummary(sum$doc_conc)\n\nwindows()\nhist((sum$DIC_epi)/sum$Vepi*12)\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/hanson_dic_cumFreq.png',\n    width = 7,height = 7,res = 300,units = 'in')\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\nlwd=8\nhanson<-hanson[sort.list(hanson$dic),]\nhanson$i<-seq(1,length(hanson$wbic),1)/length(hanson$wbic)\nplot(hanson$i[hanson$dic>0]~hanson$dic[hanson$dic>0],type='l',lwd=8,xlab='DIC mg L-1',cex.lab=cex.lab,\n     cex.axis=cex.axis,ylab='Cumulaive Fraction',col='grey60')\nsum$dic_conc<-sum$DIC_epi/sum$Vepi*12\nsum<-sum[sort.list(sum$dic_conc),]\nsum$i=seq(1,length(sum$Area),1)\nsum$i<-sum$i/length(sum$Permanent_)\nlines(sum$i~sum$dic_conc,lwd=8)\n# axis(1,at=c(log10(1),log10(5),log10(10),log10(30),log10(100)),labels=c(1,5,10,30,100),cex.axis=2)\nlegend(x = 11,y = .85,legend = c('Modeled','Random Sampling'),fill = c('black','grey60'),bty='n',cex = 1.5)\ndev.off()\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/hanson_dic_1to1.png',\n    width = 7,height = 7,res = 300,units = 'in')\npar(bty='l',mar=c(5,6,5,5))\ntemp=merge(hanson,sum,by='Permanent_',all.x=T)\ntemp=temp[!is.na(temp$dic_conc[temp$dic>0]),]\nplot(temp$dic[temp$dic>0]~temp$dic_conc[temp$dic>0],pch=16,cex=2,xlim=c(0,20),ylim=c(0,20),cex.axis=2,\n     cex.lab=2,ylab='Observed (mg C L-1)',xlab='Modeled (mg C L-1)')\nabline(0,1,lwd=3,lty=2)\ntext(x = 17,y = 14,labels = '1:1',cex = 2)\ndev.off()\n# abline(lm(temp$dic[temp$dic>0]~temp$dic_conc[temp$dic>0]))\n# res=resid(lm(temp$dic[temp$dic>0]~temp$dic_conc[temp$dic>0]))\n# plot(res[temp$dic>0&temp$dic<2]~temp$elevation[temp$dic>0&temp$dic<2],pch=16,cex=2)\nsummary(temp$dic[temp$dic>0])\nsummary(temp$dic_conc)\n\n\n\ntemp=merge(hanson,sum,by='Permanent_',all.x=T)\nplot(temp$doc[temp$doc>0]~temp$doc_conc[temp$doc>0],pch=16,cex=2,xlim=c(0,32),ylim=c(0,32),cex.axis=2,\n     cex.lab=2,ylab='Observed (mg C L-1)',xlab='Modeled (mg C L-1)') # see Canham et al 2004 Fig. 2 \nabline(0,1,lwd=3,lty=2)\ndev.off()\n\nwindows()\nhist((sum$Sed_tPOC+sum$Sed_phyto)/sum$Area*12*1000)\n\nwindows()\nhist((sum$Burial_tPOC+sum$Burial_phyto)/(sum$Sed_tPOC+sum$Sed_phyto))\n\nwindows()\nhist(sum$Emit/sum$Area*12*1000)\nsummary(sum$Emit/sum$Area*12*1000)\n\nwindows()\nhist(sum$GPP*12*sum$zmix*1000)\nsummary(sum$GPP*12*sum$zmix*1000)\n\nwindows()\nhist((sum$DOCl_hypo+sum$DOCr_hypo)/sum$Vhypo*12)\nsummary((sum$DOCl_hypo+sum$DOCr_hypo)/sum$Vhypo*12)\n\nwindows()\nhist(sum$epiTemp)\n\nwindows()\nhist(sum$P_epi/sum$Vepi*31*1000)\nhanson<-hanson[sort.list(hanson$totpf),]\nhanson$i<-seq(1,length(hanson$wbic),1)/length(hanson$wbic)\nplot(hanson$i[hanson$totpf>0]~hanson$totpf[hanson$totpf>0],type='l',lwd=8,xlab='SRP ug L-1',xaxt='n',cex.lab=1.5,xlim=c(0,120),\n     cex.axis=2,ylab='Cumulaive Fraction',col='grey60')\naxis(1,at=c(log10(1),log10(5),log10(10),log10(30),log10(100)),labels=c(1,5,10,30,100),cex.axis=2)\nlegend('topleft',legend = c('Modeled','Random Sampling'),fill = c('black','grey60'),bty='n' )\nsum$p_conc<-(sum$P_epi)/(sum$Vepi)*31*1000\nsum<-sum[sort.list(sum$p_conc),]\nsum$i<-seq(1,length(sum$SWin),1)\nsum$i<-sum$i/length(sum$SWin)\nlines(sum$i~sum$p_conc,lwd=8)\ntemp=merge(hanson,sum,by='Permanent_',all.x=T)\nplot(temp$totpf[temp$totpf>0]~temp$p_conc[temp$totpf>0],pch=16,cex=2,xlim=c(0,70),ylim=c(0,70),cex.axis=2,\n     cex.lab=2,ylab='Observed',xlab='Modeled')\nabline(0,1,lwd=2,lty=2)\n\nsummary(sum$p_conc)\nsummary(hanson$totpf)\n\nwindows()\nhist((sum$P_epi+sum$phyto/95)/sum$Vepi*31*1000)\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/hanson_tp_cumFreq.png',\n    width = 7,height = 7,res = 300,units = 'in')\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\nlwd=8\nhanson<-hanson[sort.list(hanson$totpuf),]\nhanson$i<-seq(1,length(hanson$wbic),1)/length(hanson$wbic)\nplot(hanson$i[hanson$totpuf>0]~hanson$totpuf[hanson$totpuf>0],type='l',lwd=8,xlab='TP ug L-1',cex.lab=cex.lab,xlim=c(0,120),\n     cex.axis=cex.axis,ylab='Cumulaive Fraction',col='grey60')\n# axis(1,at=c(log10(5),log10(10),log10(30),log10(100)),labels=c(5,10,30,100),cex.axis=2)\nlegend(x=50,y=.85,legend = c('Modeled','Random Sampling'),fill = c('black','grey60'),bty='n' ,cex = 1.5)\nsum$p_conc<-(sum$P_epi+sum$phyto/95)/sum$Vepi*31*1000\nsum<-sum[sort.list(sum$p_conc),]\nsum$i<-seq(1,length(sum$SWin),1)\nsum$i<-sum$i/length(sum$SWin)\nlines(sum$i~sum$p_conc,lwd=8)\ndev.off()\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/hanson_tp_1to1.png',\n    width = 7,height = 7,res = 300,units = 'in')\npar(bty='l',mar=c(5,6,5,5))\ntemp=merge(hanson,sum,by='Permanent_',all.x=T)\nplot(temp$totpuf[temp$totpuf>0]~temp$p_conc[temp$totpuf>0],pch=16,cex=2,xlim=c(0,70),ylim=c(0,70),cex.axis=2,\n     cex.lab=2,ylab='Observed (ug P L-1)',xlab='Modeled (ug P L-1)')\nabline(0,1,lwd=2,lty=2)\ntext(x = 60,y = 50,labels = '1:1',cex = 2)\ndev.off()\n\nsummary(sum$p_conc)\nsummary(hanson$totpuf[hanson$totpuf>0])\n\nwindows()\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/hanson_alk_cumFreq.png',\n    width = 7,height = 7,res = 300,units = 'in')\npar(mar=c(6,6,5,2))\ncex.axis=2.5\ncex.lab=2.5\ncex=2\nlwd=8\nhanson<-hanson[sort.list(hanson$alk),]\nhanson$i<-seq(1,length(hanson$wbic),1)/length(hanson$wbic)\nplot(hanson$i~hanson$alk,type='l',lwd=8,xlab='Alkalinity (uEq L-1)',cex.lab=cex.lab,xlim=c(-80,1500),\n     cex.axis=cex.axis,ylab='Cumulaive Fraction',col='grey60')\nlegend(x=600,y=.85,legend = c('Modeled','Random Sampling'),fill = c('black','grey60'),bty='n' ,cex=1.5)\nsum<-sum[sort.list(sum$alk),]\nsum$i<-seq(1,length(sum$SWin),1)\nsum$i<-sum$i/length(sum$SWin)\nlines(sum$i~sum$alk,lwd=8)\ndev.off()\n\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/hanson_alk_1to1.png',\n    width = 7,height = 7,res = 300,units = 'in')\npar(bty='l',mar=c(5,6,5,5))\ntemp=merge(hanson,sum,by='Permanent_',all.x=T)\nplot(temp$alk.x~temp$alk.y,pch=16,cex=2,cex.axis=2,ylim=c(-80,1500),xlim=c(-80,1500),\n     cex.lab=2,ylab='Observed (uEq L-1)',xlab='Modeled (uEq L-1)')\nabline(0,1,lwd=3,lty=2)\ntext(x = 1200,y = 1000,labels = '1:1',cex = 2)\ndev.off()\n\nsummary(hanson$alk)\nsummary(sum$alk)\n\nwindows()\nhanson<-hanson[sort.list(hanson$pH),]\nhanson$i<-seq(1,length(hanson$wbic),1)/length(hanson$wbic)\nplot(hanson$i~hanson$pH,type='l',lwd=8,xlab='pH',cex.lab=1.5,\n     cex.axis=2,ylab='Cumulaive Fraction',col='grey60')\nlegend('topleft',legend = c('Modeled','Random Sampling'),fill = c('black','grey60'),bty='n' )\nsum<-sum[sort.list(sum$pH),]\nsum$i<-seq(1,length(sum$SWin),1)\nsum$i<-sum$i/length(sum$SWin)\nlines(sum$i~sum$pH,lwd=8)\ntemp=merge(hanson,sum,by='Permanent_',all.x=T)\nplot(temp$pH.x~temp$pH.y,pch=16,cex=2,cex.axis=2,ylim=c(4,9),xlim=c(4,9),\n     cex.lab=2,ylab='Observed',xlab='Modeled')\nabline(0,1,lwd=2,lty=2)\nabline(lm(temp$pH.x~temp$pH.y))\nsummary(sum$pH)\nsummary(hanson$pH)\n\nsummary(sum$pH~sum$lakeSizeBins)\nsummary(hanson$pH~hanson$area)\n\nwindows()\nhist(sum$zmix)\n\nwindows()\nhist(sum$tPOC_epi/sum$Vepi*12)\n\nwindows()\nhist(sum$phyto/sum$Vepi*12*1000/50)\n\nwindows()\nhanson<-hanson[sort.list(hanson$watershed_area),]\nhanson$i<-seq(1,length(hanson$wbic),1)/length(hanson$wbic)\nplot(hanson$i~log10(hanson$watershed_area),type='l',lwd=8,xlab='WA (m2)',xaxt='n',cex.lab=1.5,\n     cex.axis=2,ylab='Cumulaive Fraction',col='grey60')\naxis(1,at=c(log10(1e4),log10(1e6),log10(1e8)),labels=c(1e4,1e6,1e8),cex.axis=2)\nwatersheds<-read.table('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Data/C model forcing data/NHLDsheds_20170323.txt',\n                       stringsAsFactors = F,header=T,sep = '\\t')\narea=sum[,c('Permanent_','Area')]\nwatersheds<-merge(watersheds,area,all.y = T)\nwatersheds$WALA<-(watersheds$Area_m2-watersheds$Area)/watersheds$Area\nwatersheds<-watersheds[sort.list(watersheds$Area_m2),]\nwatersheds$i<-seq(1,length(watersheds$FID_),1)\nwatersheds$i<-watersheds$i/length(watersheds$FID_)\nlines(watersheds$i~log10(watersheds$Area_m2),lwd=8)\nlegend('topleft',legend = c('Modeled','Random Sampling'),fill = c('black','grey60'),bty='n' )\nsummary(watersheds$Area_m2)\nsummary(hanson$watershed_area)\n\nwindows()\nhanson<-hanson[sort.list(hanson$area),]\nhanson$i<-seq(1,length(hanson$wbic),1)/length(hanson$wbic)\nplot(hanson$i~log10(hanson$area),type='l',lwd=8,xlab='LA (m2)',xaxt='n',cex.lab=1.5,\n     cex.axis=2,ylab='Cumulaive Fraction',col='grey60')\naxis(1,at=c(log10(1e4),log10(1e6),log10(1e8)),labels=c(1e4,1e6,1e8),cex.axis=2)\nwatersheds<-read.table('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Data/C model forcing data/NHLDsheds_20170323.txt',\n                       stringsAsFactors = F,header=T,sep = '\\t')\narea=sum[,c('Permanent_','Area')]\nwatersheds<-merge(watersheds,area,all.y = T)\nwatersheds<-watersheds[sort.list(watersheds$Area),]\nwatersheds$i<-seq(1,length(watersheds$FID_),1)\nwatersheds$i<-watersheds$i/length(watersheds$FID_)\nlines(watersheds$i~log10(watersheds$Area),lwd=8)\nlegend('topleft',legend = c('Modeled','Random Sampling'),fill = c('black','grey60'),bty='n' )\nsummary(watersheds$Area)\nsummary(hanson$area)\n\nwindows()\nhanson<-hanson[sort.list(hanson$watershed_area/hanson$area),]\nhanson$i<-seq(1,length(hanson$wbic),1)/length(hanson$wbic)\nplot(hanson$i~log10(hanson$watershed_area/hanson$area),type='l',lwd=8,xlab='WA:LA',cex.lab=1.5,xlim=c(log10(.1),log10(600)),xaxt='n',\n     cex.axis=2,ylab='Cumulaive Fraction',col='grey60')\naxis(1,at=c(log10(1),log10(10),log10(100)),labels=c(1,10,100),cex.axis=2)\nwatersheds<-read.table('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Data/C model forcing data/NHLDsheds_20170323.txt',\n                       stringsAsFactors = F,header=T,sep = '\\t')\narea=sum[,c('Permanent_','Area')]\nwatersheds<-merge(watersheds,area,all.y = T)\nwatersheds$WALA<-(watersheds$Area_m2-watersheds$Area)/watersheds$Area\nwatersheds<-watersheds[sort.list(watersheds$WALA),]\nwatersheds$i<-seq(1,length(watersheds$FID_),1)\nwatersheds$i<-watersheds$i/length(watersheds$FID_)\nlines(watersheds$i~log10(watersheds$WALA),lwd=8)\nlegend('topleft',legend = c('Modeled','Random Sampling'),fill = c('black','grey60'),bty='n' )\nsummary(watersheds$WALA)\nsummary(hanson$watershed_area/hanson$area)\n\nwindows()\nhanson<-hanson[sort.list(hanson$elevation),]\nhanson$i<-seq(1,length(hanson$wbic),1)/length(hanson$wbic)\nplot(hanson$i~hanson$elevation,type='l',lwd=8,xlab='Elevation (m)',cex.lab=1.5,\n     cex.axis=2,ylab='Cumulaive Fraction',col='grey60')\nsum<-sum[sort.list(sum$Elev),]\nsum$i<-seq(1,length(sum$SWin),1)\nsum$i<-sum$i/length(sum$SWin)\nlines(sum$i~sum$Elev,lwd=8)\nlegend('topleft',legend = c('Modeled','Random Sampling'),fill = c('black','grey60'),bty='n' )\n\n\nwindows()\nhanson<-hanson[sort.list(hanson$depth_at_samplesite),]\nhanson$i<-seq(1,length(hanson$wbic),1)/length(hanson$wbic)\nplot(hanson$i~hanson$depth_at_samplesite,type='l',lwd=8,xlab='Obs Max Depth (m)',cex.lab=1.5,\n     cex.axis=2,ylab='Cumulaive Fraction',col='grey60')\nsum<-sum[sort.list(sum$Stage),]\nsum$i<-seq(1,length(sum$SWin),1)\nsum$i<-sum$i/length(sum$SWin)\nlines(sum$i~sum$Stage,lwd=8)\nlegend('topleft',legend = c('Modeled','Random Sampling'),fill = c('black','grey60'),bty='n' )\ntemp=merge(hanson,sum,by='Permanent_',all.x=T)\nplot(temp$depth_at_samplesite[temp$depth_at_samplesite>0]~temp$Stage[temp$depth_at_samplesite>0],\n     pch=16,cex=2,xlim=c(0,25),ylim=c(0,25),cex.axis=2,\n     cex.lab=2,ylab='Observed',xlab='Modeled')\nabline(0,1,lwd=2,lty=2)\nsummary(sum$Stage)\nsummary(hanson$depth_at_samplesite)\n\nwindows()\nhanson2=hanson\nhanson2$top_hypolimnion<-ifelse(hanson2$top_hypolimnion<0,NA,hanson2$top_hypolimnion)\nhanson2=hanson2[!is.na(hanson2$top_hypolimnion),]\nhanson2<-hanson2[sort.list(hanson2$top_hypolimnion),]\nhanson2$i<-seq(1,length(hanson2$wbic),1)/length(hanson2$wbic)\nplot(hanson2$i~hanson2$top_hypolimnion,type='l',lwd=8,xlab='Top (m)',cex.lab=1.5,\n     cex.axis=2,ylab='Cumulaive Fraction',col='grey60')\nsum<-sum[sort.list(sum$zmix),]\nsum$i<-seq(1,length(sum$SWin),1)\nsum$i<-sum$i/length(sum$SWin)\nlines(sum$i~sum$zmix,lwd=8)\nlegend('topleft',legend = c('Modeled','Random Sampling'),fill = c('black','grey60'),bty='n' )\ntemp=merge(hanson,sum,by='Permanent_',all.x=T)\nplot(temp$top_hypolimnion[temp$top_hypolimnion>0]~temp$zmix[temp$top_hypolimnion>0],pch=16,cex=2,\n     xlim=c(0,14),ylim=c(0,14),cex.axis=2,\n     cex.lab=2,ylab='Observed',xlab='Modeled')\nabline(0,1,lwd=2,lty=2)\nsummary(hanson2$area)\nsummary(sum$Area)\n\n\n\n# LTER NTL validation chem data \nntl<-read.csv('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Validation Data/NTL LTER Chemistry/chemical_limnology_of_north_temperate_lakes_lter_primary_study_lakes__nutrients_ph_and_carbon.csv',\n              stringsAsFactors = F)\nntlChl<-read.csv('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Validation Data/NTL LTER Chl/north_temperate_lakes_lter__chlorophyll_-_trout_lake_area.csv',\n                 stringsAsFactors = F)\nntlTemp<-read.csv('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Validation Data/physical_limnology_of_the_north_temperate_lakes_primary_study_lakes.csv',\n                  stringsAsFactors = F)\nntlLookUp<-data.frame(lakeID=c('AL','BM','CR','SP','TR','TB','CB'),Permanent_=c(69886156,69886284,69886510,69886444,69886228,69886158,123148117))\nntl<-ntl[ntl$lakeid%in%ntlLookUp$lakeID,]\nntl$sampledate<-as.POSIXct(ntl$sampledate,format='%Y-%m-%d')\nntlChl<-ntlChl[ntlChl$lakeid%in%ntlLookUp$lakeID,]\nntlChl$sampledate<-as.POSIXct(ntlChl$sampledate, format='%Y-%m-%d')\nntlTemp<-ntlTemp[ntlTemp$lakeid%in%ntlLookUp$lakeID,]\nntlTemp$sampledate<-as.POSIXct(ntlTemp$sampledate, format='%Y-%m-%d')\nntlTemp<-ntlTemp[sort.list(ntlTemp$sampledate),]\n\ndir<-'D:/Jake/My Papers/NHLD Carbon Model/Results/20170818/'\nskip=6*365 # days to skip \nfor(i in 1:length(ntlLookUp$lakeID)){\n    if(ntlLookUp$lakeID[i]=='CB'){\n      cur<-read.table(file.path(dir,paste(ntlLookUp$Permanent_[i],'_C_model.txt',sep='')),header=T,sep='\\t')\n    }else{\n      cur<-read.table(file.path(dir,paste(ntlLookUp$Permanent_[i],'_CRWA_V_adj_C_model.txt',sep='')),\n                      header=T,sep='\\t')\n    }\n    cur<-cur[skip:nrow(cur),]\n    assign(paste(as.character(ntlLookUp$lakeID[i]),'Cout',sep=''),cur)\n}\n\n\n###################################\nntlMod_Obs=data.frame(lakeID=rep(NA,7),DOC_mod=rep(NA,7),DOC_obs=rep(NA,7),DOC_cor=rep(NA,7),SRP_mod=rep(NA,7),SRP_obs=rep(NA,7),\n                      SRP_cor=rep(NA,7),TP_mod=rep(NA,7),TP_obs=rep(NA,7),TP_cor=rep(NA,7),pH_mod=rep(NA,7),pH_obs=rep(NA,7),pH_cor=rep(NA,7),DIC_mod=rep(NA,7),\n                      DIC_obs=rep(NA,7),DIC_cor=rep(NA,7),Chl_mod=rep(NA,7),Chl_obs=rep(NA,7),Chl_cor=rep(NA,7),Wtr_mod=rep(NA,7),Wtr_obs=rep(NA,7),Wtr_cor=rep(NA,7))\n# TR ****************************************************\n# windows()\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/NTL_validation_all.png',\n    width=21,height = 21,res=300,units='in')\nxlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(TRCout$datetime)))\nylim=c(2,7)\ndocYlim=c(0,22)\nsrpYlim=c(0,27)\ntpYlim=c(0,41)\nphYlim=c(3,9)\ndicYlim=c(0,14)\nchlYlim=c(0,21)\nwtrYlim=c(0,25)\npar(mfrow=c(7,7),mar=c(5,6,2,2))\ncex=2\nlwd=2\ncex.axis=2\ncex.lab=2\n# plot(ntl$doc[ntl$lakeid=='TR'&ntl$depth==0&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2]]~ntl$sampledate[ntl$lakeid=='TR'&ntl$depth==0&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((TRCout$DOCr_epi+TRCout$DOCl_epi)/(TRCout$Vepi)*12~as.POSIXct(TRCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='DOC mg L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=TRCout\ntempntl=ntl[ntl$lakeid=='TR'&ntl$depth<=1&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$DOCr_epi+temp$DOCl_epi)/temp$Vepi*12,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$doc,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','doc')\ncolnames(tempntl)<-c('month','doc')\n# windows()\nylim=range(temp$doc,tempntl$doc)\nplot(temp$doc~temp$month,pch=16,type='o',ylim=docYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='DOC (mg L-1)',\n     xlab='')\npoints(tempntl$doc~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$lakeID[1]='TR'\nntlMod_Obs$DOC_mod[1]=mean(temp$doc)\nntlMod_Obs$DOC_obs[1]=mean(tempntl$doc)\nntlMod_Obs$DOC_cor[1]=cor(temp$doc[temp$month%in%tempntl$month],tempntl$doc)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(TRCout$datetime)))\nylim=c(0,20)\n# plot(ntl$totpf[ntl$lakeid=='TR'&ntl$depth==0&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='TR'&ntl$depth==0&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(TRCout$P_epi/(TRCout$Vepi)*31*1000~as.POSIXct(TRCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='SRP ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=TRCout\ntempntl=ntl[ntl$lakeid=='TR'&ntl$depth<=1&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$P_epi/(temp$Vepi)*31*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$totpf,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','srp')\ncolnames(tempntl)<-c('month','srp')\n# windows()\nylim=range(temp$srp,tempntl$srp)\nplot(temp$srp~temp$month,pch=16,type='o',ylim=srpYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='SRP (ug L-1)',\n     xlab='')\npoints(tempntl$srp~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$SRP_mod[1]=mean(temp$srp)\nntlMod_Obs$SRP_obs[1]=mean(tempntl$srp)\nntlMod_Obs$SRP_cor[1]=cor(temp$srp[temp$month%in%tempntl$month],tempntl$srp)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(TRCout$datetime)))\nylim=c(0,40)\n# plot(ntl$totpuf[ntl$lakeid=='TR'&ntl$depth==0&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='TR'&ntl$depth==0&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((TRCout$P_epi+TRCout$phyto/95)/(TRCout$Vepi)*31*1000~as.POSIXct(TRCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='TP ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=TRCout\ntempntl=ntl[ntl$lakeid=='TR'&ntl$depth<=1&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$P_epi+temp$phyto/95)/(temp$Vepi)*31*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$totpuf,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','tp')\ncolnames(tempntl)<-c('month','tp')\n# windows()\nylim=range(temp$tp,tempntl$tp)\nplot(temp$tp~temp$month,pch=16,type='o',ylim=tpYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='TP (ug L-1)',\n     xlab='')\npoints(tempntl$tp~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$TP_mod[1]=mean(temp$tp)\nntlMod_Obs$TP_obs[1]=mean(tempntl$tp)\nntlMod_Obs$TP_cor[1]=cor(temp$tp[temp$month%in%tempntl$month],tempntl$tp)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(TRCout$datetime)))\nylim=c(6,10)\n# plot(ntl$ph[ntl$lakeid=='TR'&ntl$depth==0&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='TR'&ntl$depth==0&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(TRCout$pH~as.POSIXct(TRCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='pH',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=TRCout\ntempntl=ntl[ntl$lakeid=='TR'&ntl$depth<=4&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$pH,by=list(temp$month),FUN=mean,na.rm=T)\ntempntl=aggregate(tempntl$ph,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','pH')\ncolnames(tempntl)<-c('month','pH')\n# windows()\nylim=range(temp$pH,tempntl$pH)\nplot(temp$pH~temp$month,pch=16,type='o',ylim=phYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='pH',\n     xlab='')\npoints(tempntl$pH~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$pH_mod[1]=mean(temp$pH)\nntlMod_Obs$pH_obs[1]=mean(tempntl$pH)\nntlMod_Obs$pH_cor[1]=cor(temp$pH[temp$month%in%tempntl$month],tempntl$pH)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(TRCout$datetime)))\nylim=c(0,20)\n# plot(ntl$dic[ntl$lakeid=='TR'&ntl$depth==0&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='TR'&ntl$depth==0&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(TRCout$DIC_epi/TRCout$Vepi*12~as.POSIXct(TRCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='DIC mg L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=TRCout\ntempntl=ntl[ntl$lakeid=='TR'&ntl$depth<=4&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$DIC_epi/temp$Vepi*12,by=list(temp$month),FUN=mean,na.rm=T)\ntempntl=aggregate(tempntl$dic,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','dic')\ncolnames(tempntl)<-c('month','dic')\n# windows()\nylim=range(temp$dic,tempntl$dic)\nplot(temp$dic~temp$month,pch=16,type='o',ylim=dicYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='DIC (mg L-1)',\n     xlab='')\npoints(tempntl$dic~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$DIC_mod[1]=mean(temp$dic)\nntlMod_Obs$DIC_obs[1]=mean(tempntl$dic)\nntlMod_Obs$DIC_cor[1]=cor(temp$dic[temp$month%in%tempntl$month],tempntl$dic)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(TRCout$datetime)))\nylim=c(0,10)\n# plot(ntlChl$chlor[ntlChl$lakeid=='TR'&ntlChl$depth==0&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2]]~\n#        ntlChl$sampledate[ntlChl$lakeid=='TR'&ntlChl$depth==0&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((TRCout$phyto/50)/(TRCout$Vepi)*12*1000~as.POSIXct(TRCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='Chl-a ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=TRCout\ntempntl=ntlChl[ntlChl$lakeid=='TR'&ntlChl$depth<=4&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$phyto/50)/(temp$Vepi)*12*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$chlor,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','chl')\ncolnames(tempntl)<-c('month','chl')\n# windows()\nylim=range(temp$chl,tempntl$chl)\nplot(temp$chl~temp$month,pch=16,type='o',ylim=chlYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Chl (ug L-1)',\n     xlab='')\npoints(tempntl$chl~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$Chl_mod[1]=mean(temp$chl)\nntlMod_Obs$Chl_obs[1]=mean(tempntl$chl)\nntlMod_Obs$Chl_cor[1]=cor(temp$chl[temp$month%in%tempntl$month],tempntl$chl)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(TRCout$datetime)))\n# plot(ntlTemp$wtemp[ntlTemp$depth==1&ntlTemp$lakeid=='TR']~ntlTemp$sampledate[ntlTemp$depth==1&ntlTemp$lakeid=='TR'],type='l',xlim=xlim,\n#      ylab='Temp C',xlab='',lwd=2,cex.lab=1.5,cex.axis=2,col='grey60')\n# lines(TRCout$epiTemp~as.POSIXct(TRCout$datetime),lwd=2)\n\ntemp=TRCout\ntempntl=ntlTemp[ntlTemp$depth==1&ntlTemp$lakeid=='TR'&!is.na(ntlTemp$wtemp),]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$epiTemp,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$wtemp,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','wtr')\ncolnames(tempntl)<-c('month','wtr')\n# windows()\nylim=range(temp$wtr,tempntl$wtr)\nplot(temp$wtr~temp$month,pch=16,type='o',ylim=wtrYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Epi Temp (deg C)',\n     xlab='')\npoints(tempntl$wtr~tempntl$month,col='grey60',pch=16,type='o',cex=2)\n\nntlMod_Obs$Wtr_mod[1]=mean(temp$wtr)\nntlMod_Obs$Wtr_obs[1]=mean(tempntl$wtr)\nntlMod_Obs$Wtr_cor[1]=cor(temp$wtr[temp$month%in%tempntl$month],tempntl$wtr)\n\n# dev.off()\n\n# **********************************************************\n\n# CR ****************************************************\n# windows()\n# png('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/CR_validation.png',width=49,height = 7,res=300,units='in')\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(CRCout$datetime)))\nylim=c(0,10)\n# par(mfrow=c(1,7),mar=c(5,6,2,2))\ncex=2\nlwd=2\ncex.axis=2\ncex.lab=2\n# plot(ntl$doc[ntl$lakeid=='CR'&ntl$depth==0&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2]]~ntl$sampledate[ntl$lakeid=='CR'&ntl$depth==0&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((CRCout$DOCr_epi+CRCout$DOCl_epi)/(CRCout$Vepi)*12~as.POSIXct(CRCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='DOC mg L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=CRCout\ntempntl=ntl[ntl$lakeid=='CR'&ntl$depth<=1&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$DOCr_epi+temp$DOCl_epi)/temp$Vepi*12,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$doc,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','doc')\ncolnames(tempntl)<-c('month','doc')\n# windows()\nylim=range(temp$doc,tempntl$doc)\nplot(temp$doc~temp$month,pch=16,type='o',ylim=docYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='DOC (mg L-1)',\n     xlab='')\npoints(tempntl$doc~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$lakeID[2]='CR'\nntlMod_Obs$DOC_mod[2]=mean(temp$doc)\nntlMod_Obs$DOC_obs[2]=mean(tempntl$doc)\nntlMod_Obs$DOC_cor[2]=cor(temp$doc[temp$month%in%tempntl$month],tempntl$doc)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(CRCout$datetime)))\nylim=c(0,10)\n# plot(ntl$totpf[ntl$lakeid=='CR'&ntl$depth==0&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='CR'&ntl$depth==0&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(CRCout$P_epi/(CRCout$Vepi)*31*1000~as.POSIXct(CRCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='SRP ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=CRCout\ntempntl=ntl[ntl$lakeid=='CR'&ntl$depth<=1&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$P_epi/(temp$Vepi)*31*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$totpf,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','srp')\ncolnames(tempntl)<-c('month','srp')\n# windows()\nylim=range(temp$srp,tempntl$srp)\nplot(temp$srp~temp$month,pch=16,type='o',ylim=srpYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='SRP (ug L-1)',\n     xlab='')\npoints(tempntl$srp~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$SRP_mod[2]=mean(temp$srp)\nntlMod_Obs$SRP_obs[2]=mean(tempntl$srp)\nntlMod_Obs$SRP_cor[2]=cor(temp$srp[temp$month%in%tempntl$month],tempntl$srp)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(CRCout$datetime)))\nylim=c(0,20)\n# plot(ntl$totpuf[ntl$lakeid=='CR'&ntl$depth==0&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='CR'&ntl$depth==0&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((CRCout$P_epi+CRCout$phyto/95)/(CRCout$Vepi)*31*1000~as.POSIXct(CRCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='TP ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=CRCout\ntempntl=ntl[ntl$lakeid=='CR'&ntl$depth<=1&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$P_epi+temp$phyto/95)/(temp$Vepi)*31*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$totpuf,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','tp')\ncolnames(tempntl)<-c('month','tp')\n# windows()\nylim=range(temp$tp,tempntl$tp)\nplot(temp$tp~temp$month,pch=16,type='o',ylim=tpYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='TP (ug L-1)',\n     xlab='')\npoints(tempntl$tp~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$TP_mod[2]=mean(temp$tp)\nntlMod_Obs$TP_obs[2]=mean(tempntl$tp)\nntlMod_Obs$TP_cor[2]=cor(temp$tp[temp$month%in%tempntl$month],tempntl$tp)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(CRCout$datetime)))\nylim=c(3,10)\n# plot(ntl$ph[ntl$lakeid=='CR'&ntl$depth==0&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='CR'&ntl$depth==0&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(CRCout$pH~as.POSIXct(CRCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='pH',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=CRCout\ntempntl=ntl[ntl$lakeid=='CR'&ntl$depth<=4&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$pH,by=list(temp$month),FUN=mean,na.rm=T)\ntempntl=aggregate(tempntl$ph,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','pH')\ncolnames(tempntl)<-c('month','pH')\n# windows()\nylim=range(temp$pH,tempntl$pH)\nplot(temp$pH~temp$month,pch=16,type='o',ylim=phYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='pH',\n     xlab='')\npoints(tempntl$pH~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$pH_mod[2]=mean(temp$pH)\nntlMod_Obs$pH_obs[2]=mean(tempntl$pH)\nntlMod_Obs$pH_cor[2]=cor(temp$pH[temp$month%in%tempntl$month],tempntl$pH)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(CRCout$datetime)))\nylim=c(0,20)\n# plot(ntl$dic[ntl$lakeid=='CR'&ntl$depth==0&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='CR'&ntl$depth==0&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(CRCout$DIC_epi/CRCout$Vepi*12~as.POSIXct(CRCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='DIC mg L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=CRCout\ntempntl=ntl[ntl$lakeid=='CR'&ntl$depth<=4&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$DIC_epi/temp$Vepi*12,by=list(temp$month),FUN=mean,na.rm=T)\ntempntl=aggregate(tempntl$dic,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','dic')\ncolnames(tempntl)<-c('month','dic')\n# windows()\nylim=range(temp$dic,tempntl$dic)\nplot(temp$dic~temp$month,pch=16,type='o',ylim=dicYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='DIC (mg L-1)',\n     xlab='')\npoints(tempntl$dic~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$DIC_mod[2]=mean(temp$dic)\nntlMod_Obs$DIC_obs[2]=mean(tempntl$dic)\nntlMod_Obs$DIC_cor[2]=cor(temp$dic[temp$month%in%tempntl$month],tempntl$dic)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(CRCout$datetime)))\nylim=c(0,30)\n# plot(ntlChl$chlor[ntlChl$lakeid=='CR'&ntlChl$depth==0&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2]]~\n#        ntlChl$sampledate[ntlChl$lakeid=='CR'&ntlChl$depth==0&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((CRCout$phyto/50)/(CRCout$Vepi)*12*1000~as.POSIXct(CRCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='Chl-a ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=CRCout\ntempntl=ntlChl[ntlChl$lakeid=='CR'&ntlChl$depth<=2&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$phyto/50)/(temp$Vepi)*12*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$chlor,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','chl')\ncolnames(tempntl)<-c('month','chl')\n# windows()\nylim=range(temp$chl,tempntl$chl)\nplot(temp$chl~temp$month,pch=16,type='o',ylim=chlYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Chl (ug L-1)',\n     xlab='')\npoints(tempntl$chl~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$Chl_mod[2]=mean(temp$chl)\nntlMod_Obs$Chl_obs[2]=mean(tempntl$chl)\nntlMod_Obs$Chl_cor[2]=cor(temp$chl[temp$month%in%tempntl$month],tempntl$chl)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(CRCout$datetime)))\n# plot(ntlTemp$wtemp[ntlTemp$depth==1&ntlTemp$lakeid=='CR']~ntlTemp$sampledate[ntlTemp$depth==1&ntlTemp$lakeid=='CR'],type='l',xlim=xlim,\n#      ylab='Temp C',xlab='',lwd=2,cex.lab=1.5,cex.axis=2,col='grey60')\n# lines(CRCout$epiTemp~as.POSIXct(CRCout$datetime),lwd=2)\n\ntemp=CRCout\ntempntl=ntlTemp[ntlTemp$depth==1&ntlTemp$lakeid=='CR'&!is.na(ntlTemp$wtemp),]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$epiTemp,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$wtemp,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','wtr')\ncolnames(tempntl)<-c('month','wtr')\n# windows()\nylim=range(temp$wtr,tempntl$wtr)\nplot(temp$wtr~temp$month,pch=16,type='o',ylim=wtrYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Epi Temp (deg C)',\n     xlab='')\npoints(tempntl$wtr~tempntl$month,col='grey60',pch=16,type='o',cex=2)\n\nntlMod_Obs$Wtr_mod[2]=mean(temp$wtr)\nntlMod_Obs$Wtr_obs[2]=mean(tempntl$wtr)\nntlMod_Obs$Wtr_cor[2]=cor(temp$wtr[temp$month%in%tempntl$month],tempntl$wtr)\n\n# dev.off()\n# **********************************************************\n\n\n# CB ****************************************************\n# windows()\n# png('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/CB_validation.png',width=49,height = 7,res=300,units='in')\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(CBCout$datetime)))\nylim=c(2,30)\n# par(mfrow=c(1,7),mar=c(5,6,2,2))\ncex=2\nlwd=2\ncex.axis=2\ncex.lab=2\n# plot(ntl$doc[ntl$lakeid=='CB'&ntl$depth==0&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2]]~ntl$sampledate[ntl$lakeid=='CB'&ntl$depth==0&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((CBCout$DOCr_epi+CBCout$DOCl_epi)/(CBCout$Vepi)*12~as.POSIXct(CBCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='DOC mg L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=CBCout\ntempntl=ntl[ntl$lakeid=='CB'&ntl$depth<=1&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$DOCr_epi+temp$DOCl_epi)/temp$Vepi*12,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$doc,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','doc')\ncolnames(tempntl)<-c('month','doc')\n# windows()\nylim=range(temp$doc,tempntl$doc)\nplot(temp$doc~temp$month,pch=16,type='o',ylim=docYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='DOC (mg L-1)',\n     xlab='')\npoints(tempntl$doc~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$lakeID[3]='CB'\nntlMod_Obs$DOC_mod[3]=mean(temp$doc)\nntlMod_Obs$DOC_obs[3]=mean(tempntl$doc)\nntlMod_Obs$DOC_cor[3]=cor(temp$doc[temp$month%in%tempntl$month],tempntl$doc)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(CBCout$datetime)))\nylim=c(0,50)\n# plot(ntl$totpf[ntl$lakeid=='CB'&ntl$depth==0&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='CB'&ntl$depth==0&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(CBCout$P_epi/(CBCout$Vepi)*31*1000~as.POSIXct(CBCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='SRP ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=CBCout\ntempntl=ntl[ntl$lakeid=='CB'&ntl$depth<=1&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$P_epi/(temp$Vepi)*31*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$totpf,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','srp')\ncolnames(tempntl)<-c('month','srp')\n# windows()\nylim=range(temp$srp,tempntl$srp)\nplot(temp$srp~temp$month,pch=16,type='o',ylim=srpYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='SRP (ug L-1)',\n     xlab='')\npoints(tempntl$srp~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$SRP_mod[3]=mean(temp$srp)\nntlMod_Obs$SRP_obs[3]=mean(tempntl$srp)\nntlMod_Obs$SRP_cor[3]=cor(temp$srp[temp$month%in%tempntl$month],tempntl$srp)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(CBCout$datetime)))\nylim=c(0,50)\n# plot(ntl$totpuf[ntl$lakeid=='CB'&ntl$depth==0&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='CB'&ntl$depth==0&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((CBCout$P_epi+CBCout$phyto/95)/(CBCout$Vepi)*31*1000~as.POSIXct(CBCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='TP ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=CBCout\ntempntl=ntl[ntl$lakeid=='CB'&ntl$depth<=1&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$P_epi+temp$phyto/95)/(temp$Vepi)*31*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$totpuf,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','tp')\ncolnames(tempntl)<-c('month','tp')\n# windows()\nylim=range(temp$tp,tempntl$tp)\nplot(temp$tp~temp$month,pch=16,type='o',ylim=tpYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='TP (ug L-1)',\n     xlab='')\npoints(tempntl$tp~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$TP_mod[3]=mean(temp$tp)\nntlMod_Obs$TP_obs[3]=mean(tempntl$tp)\nntlMod_Obs$TP_cor[3]=cor(temp$tp[temp$month%in%tempntl$month],tempntl$tp)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(CBCout$datetime)))\nylim=c(3,10)\n# plot(ntl$ph[ntl$lakeid=='CB'&ntl$depth==0&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='CB'&ntl$depth==0&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(CBCout$pH~as.POSIXct(CBCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='pH',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=CBCout\ntempntl=ntl[ntl$lakeid=='CB'&ntl$depth<=4&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$pH,by=list(temp$month),FUN=mean,na.rm=T)\ntempntl=aggregate(tempntl$ph,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','pH')\ncolnames(tempntl)<-c('month','pH')\n# windows()\nylim=range(temp$pH,tempntl$pH)\nplot(temp$pH~temp$month,pch=16,type='o',ylim=phYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='pH',\n     xlab='')\npoints(tempntl$pH~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$pH_mod[3]=mean(temp$pH)\nntlMod_Obs$pH_obs[3]=mean(tempntl$pH)\nntlMod_Obs$pH_cor[3]=cor(temp$pH[temp$month%in%tempntl$month],tempntl$pH)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(CBCout$datetime)))\nylim=c(0,20)\n# plot(ntl$dic[ntl$lakeid=='CB'&ntl$depth==0&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='CB'&ntl$depth==0&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(CBCout$DIC_epi/CBCout$Vepi*12~as.POSIXct(CBCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='DIC mg L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=CBCout\ntempntl=ntl[ntl$lakeid=='CB'&ntl$depth<=4&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$DIC_epi/temp$Vepi*12,by=list(temp$month),FUN=mean,na.rm=T)\ntempntl=aggregate(tempntl$dic,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','dic')\ncolnames(tempntl)<-c('month','dic')\n# windows()\nylim=range(temp$dic,tempntl$dic)\nplot(temp$dic~temp$month,pch=16,type='o',ylim=dicYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='DIC (mg L-1)',\n     xlab='')\npoints(tempntl$dic~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$DIC_mod[3]=mean(temp$dic)\nntlMod_Obs$DIC_obs[3]=mean(tempntl$dic)\nntlMod_Obs$DIC_cor[3]=cor(temp$dic[temp$month%in%tempntl$month],tempntl$dic)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(CBCout$datetime)))\nylim=c(0,30)\n# plot(ntlChl$chlor[ntlChl$lakeid=='CB'&ntlChl$depth==0&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2]]~\n#        ntlChl$sampledate[ntlChl$lakeid=='CB'&ntlChl$depth==0&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((CBCout$phyto/50)/(CBCout$Vepi)*12*1000~as.POSIXct(CBCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='Chl-a ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=CBCout\ntempntl=ntlChl[ntlChl$lakeid=='CB'&ntlChl$depth<=2&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$phyto/50)/(temp$Vepi)*12*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$chlor,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','chl')\ncolnames(tempntl)<-c('month','chl')\n# windows()\nylim=range(temp$chl,tempntl$chl)\nplot(temp$chl~temp$month,pch=16,type='o',ylim=chlYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Chl (ug L-1)',\n     xlab='')\npoints(tempntl$chl~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$Chl_mod[3]=mean(temp$chl)\nntlMod_Obs$Chl_obs[3]=mean(tempntl$chl)\nntlMod_Obs$Chl_cor[3]=cor(temp$chl[temp$month%in%tempntl$month],tempntl$chl)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(CBCout$datetime)))\n# plot(ntlTemp$wtemp[ntlTemp$depth==1&ntlTemp$lakeid=='CB']~ntlTemp$sampledate[ntlTemp$depth==1&ntlTemp$lakeid=='CB'],type='l',xlim=xlim,\n#      ylab='Temp C',xlab='',lwd=2,cex.lab=1.5,cex.axis=2,col='grey60')\n# lines(CBCout$epiTemp~as.POSIXct(CBCout$datetime),lwd=2)\n\ntemp=CBCout\ntempntl=ntlTemp[ntlTemp$depth==1&ntlTemp$lakeid=='CB'&!is.na(ntlTemp$wtemp),]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$epiTemp,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$wtemp,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','wtr')\ncolnames(tempntl)<-c('month','wtr')\n# windows()\nylim=range(temp$wtr,tempntl$wtr)\nplot(temp$wtr~temp$month,pch=16,type='o',ylim=wtrYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Epi Temp (deg C)',\n     xlab='')\npoints(tempntl$wtr~tempntl$month,col='grey60',pch=16,type='o',cex=2)\n\nntlMod_Obs$Wtr_mod[3]=mean(temp$wtr)\nntlMod_Obs$Wtr_obs[3]=mean(tempntl$wtr)\nntlMod_Obs$Wtr_cor[3]=cor(temp$wtr[temp$month%in%tempntl$month],tempntl$wtr)\n\n# dev.off()\n# **********************************************************\n\n# BM ****************************************************\n# windows()\n# png('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/BM_validation.png',width=49,height = 7,res=300,units='in')\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(BMCout$datetime)))\nylim=c(2,30)\n# par(mfrow=c(1,7),mar=c(5,6,2,2))\ncex=2\nlwd=2\ncex.axis=2\ncex.lab=2\n# plot(ntl$doc[ntl$lakeid=='BM'&ntl$depth==0&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2]]~ntl$sampledate[ntl$lakeid=='BM'&ntl$depth==0&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((BMCout$DOCr_epi+BMCout$DOCl_epi)/(BMCout$Vepi)*12~as.POSIXct(BMCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='DOC mg L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=BMCout\ntempntl=ntl[ntl$lakeid=='BM'&ntl$depth<=1&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$DOCr_epi+temp$DOCl_epi)/temp$Vepi*12,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$doc,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','doc')\ncolnames(tempntl)<-c('month','doc')\n# windows()\nylim=range(temp$doc,tempntl$doc)\nplot(temp$doc~temp$month,pch=16,type='o',ylim=docYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='DOC (mg L-1)',\n     xlab='')\npoints(tempntl$doc~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$lakeID[4]='BM'\nntlMod_Obs$DOC_mod[4]=mean(temp$doc)\nntlMod_Obs$DOC_obs[4]=mean(tempntl$doc)\nntlMod_Obs$DOC_cor[4]=cor(temp$doc[temp$month%in%tempntl$month],tempntl$doc)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(BMCout$datetime)))\nylim=c(0,50)\n# plot(ntl$totpf[ntl$lakeid=='BM'&ntl$depth==0&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='BM'&ntl$depth==0&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(BMCout$P_epi/(BMCout$Vepi)*31*1000~as.POSIXct(BMCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='SRP ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=BMCout\ntempntl=ntl[ntl$lakeid=='BM'&ntl$depth<=1&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$P_epi/(temp$Vepi)*31*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$totpf,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','srp')\ncolnames(tempntl)<-c('month','srp')\n# windows()\nylim=range(temp$srp,tempntl$srp)\nplot(temp$srp~temp$month,pch=16,type='o',ylim=srpYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='SRP (ug L-1)',\n     xlab='')\npoints(tempntl$srp~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$SRP_mod[4]=mean(temp$srp)\nntlMod_Obs$SRP_obs[4]=mean(tempntl$srp)\nntlMod_Obs$SRP_cor[4]=cor(temp$srp[temp$month%in%tempntl$month],tempntl$srp)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(BMCout$datetime)))\nylim=c(0,50)\n# plot(ntl$totpuf[ntl$lakeid=='BM'&ntl$depth==0&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='BM'&ntl$depth==0&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((BMCout$P_epi+BMCout$phyto/95)/(BMCout$Vepi)*31*1000~as.POSIXct(BMCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='TP ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=BMCout\ntempntl=ntl[ntl$lakeid=='BM'&ntl$depth<=1&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$P_epi+temp$phyto/95)/(temp$Vepi)*31*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$totpuf,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','tp')\ncolnames(tempntl)<-c('month','tp')\n# windows()\nylim=range(temp$tp,tempntl$tp)\nplot(temp$tp~temp$month,pch=16,type='o',ylim=tpYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='TP (ug L-1)',\n     xlab='')\npoints(tempntl$tp~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$TP_mod[4]=mean(temp$tp)\nntlMod_Obs$TP_obs[4]=mean(tempntl$tp)\nntlMod_Obs$TP_cor[4]=cor(temp$tp[temp$month%in%tempntl$month],tempntl$tp)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(BMCout$datetime)))\nylim=c(3,10)\n# plot(ntl$ph[ntl$lakeid=='BM'&ntl$depth==0&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='BM'&ntl$depth==0&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(BMCout$pH~as.POSIXct(BMCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='pH',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=BMCout\ntempntl=ntl[ntl$lakeid=='BM'&ntl$depth<=4&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$pH,by=list(temp$month),FUN=mean,na.rm=T)\ntempntl=aggregate(tempntl$ph,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','pH')\ncolnames(tempntl)<-c('month','pH')\n# windows()\nylim=range(temp$pH,tempntl$pH)\nplot(temp$pH~temp$month,pch=16,type='o',ylim=phYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='pH',\n     xlab='')\npoints(tempntl$pH~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$pH_mod[4]=mean(temp$pH)\nntlMod_Obs$pH_obs[4]=mean(tempntl$pH)\nntlMod_Obs$pH_cor[4]=cor(temp$pH[temp$month%in%tempntl$month],tempntl$pH)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(BMCout$datetime)))\nylim=c(0,20)\n# plot(ntl$dic[ntl$lakeid=='BM'&ntl$depth==0&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='BM'&ntl$depth==0&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(BMCout$DIC_epi/BMCout$Vepi*12~as.POSIXct(BMCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='DIC mg L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=BMCout\ntempntl=ntl[ntl$lakeid=='BM'&ntl$depth<=4&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$DIC_epi/temp$Vepi*12,by=list(temp$month),FUN=mean,na.rm=T)\ntempntl=aggregate(tempntl$dic,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','dic')\ncolnames(tempntl)<-c('month','dic')\n# windows()\nylim=range(temp$dic,tempntl$dic)\nplot(temp$dic~temp$month,pch=16,type='o',ylim=dicYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='DIC (mg L-1)',\n     xlab='')\npoints(tempntl$dic~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$DIC_mod[4]=mean(temp$dic)\nntlMod_Obs$DIC_obs[4]=mean(tempntl$dic)\nntlMod_Obs$DIC_cor[4]=cor(temp$dic[temp$month%in%tempntl$month],tempntl$dic)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(BMCout$datetime)))\nylim=c(0,30)\n# plot(ntlChl$chlor[ntlChl$lakeid=='BM'&ntlChl$depth==0&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2]]~\n#        ntlChl$sampledate[ntlChl$lakeid=='BM'&ntlChl$depth==0&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((BMCout$phyto/50)/(BMCout$Vepi)*12*1000~as.POSIXct(BMCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='Chl-a ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=BMCout\ntempntl=ntlChl[ntlChl$lakeid=='BM'&ntlChl$depth<=2&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$phyto/50)/(temp$Vepi)*12*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$chlor,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','chl')\ncolnames(tempntl)<-c('month','chl')\n# windows()\nylim=range(temp$chl,tempntl$chl)\nplot(temp$chl~temp$month,pch=16,type='o',ylim=chlYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Chl (ug L-1)',\n     xlab='')\npoints(tempntl$chl~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$Chl_mod[4]=mean(temp$chl)\nntlMod_Obs$Chl_obs[4]=mean(tempntl$chl)\nntlMod_Obs$Chl_cor[4]=cor(temp$chl[temp$month%in%tempntl$month],tempntl$chl)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(BMCout$datetime)))\n# plot(ntlTemp$wtemp[ntlTemp$depth==1&ntlTemp$lakeid=='BM']~ntlTemp$sampledate[ntlTemp$depth==1&ntlTemp$lakeid=='BM'],type='l',xlim=xlim,\n#      ylab='Temp C',xlab='',lwd=2,cex.lab=1.5,cex.axis=2,col='grey60')\n# lines(BMCout$epiTemp~as.POSIXct(BMCout$datetime),lwd=2)\n\ntemp=BMCout\ntempntl=ntlTemp[ntlTemp$depth==1&ntlTemp$lakeid=='BM'&!is.na(ntlTemp$wtemp),]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$epiTemp,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$wtemp,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','wtr')\ncolnames(tempntl)<-c('month','wtr')\n# windows()\nylim=range(temp$wtr,tempntl$wtr)\nplot(temp$wtr~temp$month,pch=16,type='o',ylim=wtrYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Epi Temp (deg C)',\n     xlab='')\npoints(tempntl$wtr~tempntl$month,col='grey60',pch=16,type='o',cex=2)\n\nntlMod_Obs$Wtr_mod[4]=mean(temp$wtr)\nntlMod_Obs$Wtr_obs[4]=mean(tempntl$wtr)\nntlMod_Obs$Wtr_cor[4]=cor(temp$wtr[temp$month%in%tempntl$month],tempntl$wtr)\n\n# dev.off()\n# **********************************************************\n\n\n# SP ****************************************************\n# windows()\n# png('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/SP_validation.png',width=49,height = 7,res=300,units='in')\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(SPCout$datetime)))\nylim=c(0,10)\n# par(mfrow=c(1,7),mar=c(5,6,2,2))\ncex=2\nlwd=2\ncex.axis=2\ncex.lab=2\n# plot(ntl$doc[ntl$lakeid=='SP'&ntl$depth==0&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2]]~ntl$sampledate[ntl$lakeid=='SP'&ntl$depth==0&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((SPCout$DOCr_epi+SPCout$DOCl_epi)/(SPCout$Vepi)*12~as.POSIXct(SPCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='DOC mg L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=SPCout\ntempntl=ntl[ntl$lakeid=='SP'&ntl$depth<=1&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$DOCr_epi+temp$DOCl_epi)/temp$Vepi*12,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$doc,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','doc')\ncolnames(tempntl)<-c('month','doc')\n# windows()\nylim=range(temp$doc,tempntl$doc)\nplot(temp$doc~temp$month,pch=16,type='o',ylim=docYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='DOC (mg L-1)',\n     xlab='')\npoints(tempntl$doc~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$lakeID[5]='SP'\nntlMod_Obs$DOC_mod[5]=mean(temp$doc)\nntlMod_Obs$DOC_obs[5]=mean(tempntl$doc)\nntlMod_Obs$DOC_cor[5]=cor(temp$doc[temp$month%in%tempntl$month],tempntl$doc)\n\n#windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(SPCout$datetime)))\nylim=c(0,50)\n# plot(ntl$totpf[ntl$lakeid=='SP'&ntl$depth==0&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='SP'&ntl$depth==0&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(SPCout$P_epi/(SPCout$Vepi)*31*1000~as.POSIXct(SPCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='SRP ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=SPCout\ntempntl=ntl[ntl$lakeid=='SP'&ntl$depth<=1&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$P_epi/(temp$Vepi)*31*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$totpf,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','srp')\ncolnames(tempntl)<-c('month','srp')\n# windows()\nylim=range(temp$srp,tempntl$srp)\nplot(temp$srp~temp$month,pch=16,type='o',ylim=srpYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='SRP (ug L-1)',\n     xlab='')\npoints(tempntl$srp~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$SRP_mod[5]=mean(temp$srp)\nntlMod_Obs$SRP_obs[5]=mean(tempntl$srp)\nntlMod_Obs$SRP_cor[5]=cor(temp$srp[temp$month%in%tempntl$month],tempntl$srp)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(SPCout$datetime)))\nylim=c(0,50)\n# plot(ntl$totpuf[ntl$lakeid=='SP'&ntl$depth==0&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='SP'&ntl$depth==0&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((SPCout$P_epi+SPCout$phyto/95)/(SPCout$Vepi)*31*1000~as.POSIXct(SPCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='TP ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=SPCout\ntempntl=ntl[ntl$lakeid=='SP'&ntl$depth<=1&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$P_epi+temp$phyto/95)/(temp$Vepi)*31*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$totpuf,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','tp')\ncolnames(tempntl)<-c('month','tp')\n# windows()\nylim=range(temp$tp,tempntl$tp)\nplot(temp$tp~temp$month,pch=16,type='o',ylim=tpYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='TP (ug L-1)',\n     xlab='')\npoints(tempntl$tp~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$TP_mod[5]=mean(temp$tp)\nntlMod_Obs$TP_obs[5]=mean(tempntl$tp)\nntlMod_Obs$TP_cor[5]=cor(temp$tp[temp$month%in%tempntl$month],tempntl$tp)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(SPCout$datetime)))\nylim=c(3,10)\n# plot(ntl$ph[ntl$lakeid=='SP'&ntl$depth==0&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='SP'&ntl$depth==0&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(SPCout$pH~as.POSIXct(SPCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='pH',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=SPCout\ntempntl=ntl[ntl$lakeid=='SP'&ntl$depth<=4&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$pH,by=list(temp$month),FUN=mean,na.rm=T)\ntempntl=aggregate(tempntl$ph,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','pH')\ncolnames(tempntl)<-c('month','pH')\n# windows()\nylim=range(temp$pH,tempntl$pH)\nplot(temp$pH~temp$month,pch=16,type='o',ylim=phYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='pH',\n     xlab='')\npoints(tempntl$pH~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$pH_mod[5]=mean(temp$pH)\nntlMod_Obs$pH_obs[5]=mean(tempntl$pH)\nntlMod_Obs$pH_cor[5]=cor(temp$pH[temp$month%in%tempntl$month],tempntl$pH)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(SPCout$datetime)))\nylim=c(0,20)\n# plot(ntl$dic[ntl$lakeid=='SP'&ntl$depth==0&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='SP'&ntl$depth==0&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(SPCout$DIC_epi/SPCout$Vepi*12~as.POSIXct(SPCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='DIC mg L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=SPCout\ntempntl=ntl[ntl$lakeid=='SP'&ntl$depth<=4&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$DIC_epi/temp$Vepi*12,by=list(temp$month),FUN=mean,na.rm=T)\ntempntl=aggregate(tempntl$dic,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','dic')\ncolnames(tempntl)<-c('month','dic')\n# windows()\nylim=range(temp$dic,tempntl$dic)\nplot(temp$dic~temp$month,pch=16,type='o',ylim=dicYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='DIC (mg L-1)',\n     xlab='')\npoints(tempntl$dic~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$DIC_mod[5]=mean(temp$dic)\nntlMod_Obs$DIC_obs[5]=mean(tempntl$dic)\nntlMod_Obs$DIC_cor[5]=cor(temp$dic[temp$month%in%tempntl$month],tempntl$dic)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(SPCout$datetime)))\nylim=c(0,10)\n# plot(ntlChl$chlor[ntlChl$lakeid=='SP'&ntlChl$depth==0&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2]]~\n#        ntlChl$sampledate[ntlChl$lakeid=='SP'&ntlChl$depth==0&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((SPCout$phyto/50)/(SPCout$Vepi)*12*1000~as.POSIXct(SPCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='Chl-a ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=SPCout\ntempntl=ntlChl[ntlChl$lakeid=='SP'&ntlChl$depth<=2&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$phyto/50)/(temp$Vepi)*12*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$chlor,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','chl')\ncolnames(tempntl)<-c('month','chl')\n# windows()\nylim=range(temp$chl,tempntl$chl)\nplot(temp$chl~temp$month,pch=16,type='o',ylim=chlYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Chl (ug L-1)',\n     xlab='')\npoints(tempntl$chl~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$Chl_mod[5]=mean(temp$chl)\nntlMod_Obs$Chl_obs[5]=mean(tempntl$chl)\nntlMod_Obs$Chl_cor[5]=cor(temp$chl[temp$month%in%tempntl$month],tempntl$chl)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(SPCout$datetime)))\n# plot(ntlTemp$wtemp[ntlTemp$depth==1&ntlTemp$lakeid=='SP']~ntlTemp$sampledate[ntlTemp$depth==1&ntlTemp$lakeid=='SP'],type='l',xlim=xlim,\n#      ylab='Temp C',xlab='',lwd=2,cex.lab=1.5,cex.axis=2,col='grey60')\n# lines(SPCout$epiTemp~as.POSIXct(SPCout$datetime),lwd=2)\n\ntemp=SPCout\ntempntl=ntlTemp[ntlTemp$depth==1&ntlTemp$lakeid=='SP'&!is.na(ntlTemp$wtemp),]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$epiTemp,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$wtemp,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','wtr')\ncolnames(tempntl)<-c('month','wtr')\n# windows()\nylim=range(temp$wtr,tempntl$wtr)\nplot(temp$wtr~temp$month,pch=16,type='o',ylim=wtrYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Epi Temp (deg C)',\n     xlab='')\npoints(tempntl$wtr~tempntl$month,col='grey60',pch=16,type='o',cex=2)\n\nntlMod_Obs$Wtr_mod[5]=mean(temp$wtr)\nntlMod_Obs$Wtr_obs[5]=mean(tempntl$wtr)\nntlMod_Obs$Wtr_cor[5]=cor(temp$wtr[temp$month%in%tempntl$month],tempntl$wtr)\n\n# dev.off()\n# **********************************************************\n\n# AL ****************************************************\n# windows()\n# png('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/AL_validation.png',width=49,height = 7,res=300,units='in')\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(ALCout$datetime)))\nylim=c(2,30)\n# par(mfrow=c(1,7),mar=c(5,6,2,2))\ncex=2\nlwd=2\ncex.axis=2\ncex.lab=2\n# plot(ntl$doc[ntl$lakeid=='AL'&ntl$depth==0&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2]]~ntl$sampledate[ntl$lakeid=='AL'&ntl$depth==0&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((ALCout$DOCr_epi+ALCout$DOCl_epi)/(ALCout$Vepi)*12~as.POSIXct(ALCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='DOC mg L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=ALCout\ntempntl=ntl[ntl$lakeid=='AL'&ntl$depth<=1&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$DOCr_epi+temp$DOCl_epi)/temp$Vepi*12,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$doc,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','doc')\ncolnames(tempntl)<-c('month','doc')\n# windows()\nylim=range(temp$doc,tempntl$doc)\nplot(temp$doc~temp$month,pch=16,type='o',ylim=docYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='DOC (mg L-1)',\n     xlab='')\npoints(tempntl$doc~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$lakeID[6]='AL'\nntlMod_Obs$DOC_mod[6]=mean(temp$doc)\nntlMod_Obs$DOC_obs[6]=mean(tempntl$doc)\nntlMod_Obs$DOC_cor[6]=cor(temp$doc[temp$month%in%tempntl$month],tempntl$doc)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(ALCout$datetime)))\nylim=c(0,50)\n# plot(ntl$totpf[ntl$lakeid=='AL'&ntl$depth==0&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='AL'&ntl$depth==0&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(ALCout$P_epi/(ALCout$Vepi)*31*1000~as.POSIXct(ALCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='SRP ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=ALCout\ntempntl=ntl[ntl$lakeid=='AL'&ntl$depth<=1&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$P_epi/(temp$Vepi)*31*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$totpf,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','srp')\ncolnames(tempntl)<-c('month','srp')\n# windows()\nylim=range(temp$srp,tempntl$srp)\nplot(temp$srp~temp$month,pch=16,type='o',ylim=srpYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='SRP (ug L-1)',\n     xlab='')\npoints(tempntl$srp~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$SRP_mod[6]=mean(temp$srp)\nntlMod_Obs$SRP_obs[6]=mean(tempntl$srp)\nntlMod_Obs$SRP_cor[6]=cor(temp$srp[temp$month%in%tempntl$month],tempntl$srp)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(ALCout$datetime)))\nylim=c(0,50)\n# plot(ntl$totpuf[ntl$lakeid=='AL'&ntl$depth==0&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='AL'&ntl$depth==0&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((ALCout$P_epi+ALCout$phyto/95)/(ALCout$Vepi)*31*1000~as.POSIXct(ALCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='TP ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=ALCout\ntempntl=ntl[ntl$lakeid=='AL'&ntl$depth<=1&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$P_epi+temp$phyto/95)/(temp$Vepi)*31*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$totpuf,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','tp')\ncolnames(tempntl)<-c('month','tp')\n# windows()\nylim=range(temp$tp,tempntl$tp)\nplot(temp$tp~temp$month,pch=16,type='o',ylim=tpYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='TP (ug L-1)',\n     xlab='')\npoints(tempntl$tp~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$TP_mod[6]=mean(temp$tp)\nntlMod_Obs$TP_obs[6]=mean(tempntl$tp)\nntlMod_Obs$TP_cor[6]=cor(temp$tp[temp$month%in%tempntl$month],tempntl$tp)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(ALCout$datetime)))\nylim=c(3,10)\n# plot(ntl$ph[ntl$lakeid=='AL'&ntl$depth==0&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='AL'&ntl$depth==0&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(ALCout$pH~as.POSIXct(ALCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='pH',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=ALCout\ntempntl=ntl[ntl$lakeid=='AL'&ntl$depth<=4&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$pH,by=list(temp$month),FUN=mean,na.rm=T)\ntempntl=aggregate(tempntl$ph,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','pH')\ncolnames(tempntl)<-c('month','pH')\n# windows()\nylim=range(temp$pH,tempntl$pH)\nplot(temp$pH~temp$month,pch=16,type='o',ylim=phYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='pH',\n     xlab='')\npoints(tempntl$pH~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$pH_mod[6]=mean(temp$pH)\nntlMod_Obs$pH_obs[6]=mean(tempntl$pH)\nntlMod_Obs$pH_cor[6]=cor(temp$pH[temp$month%in%tempntl$month],tempntl$pH)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(ALCout$datetime)))\nylim=c(0,20)\n# plot(ntl$dic[ntl$lakeid=='AL'&ntl$depth==0&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='AL'&ntl$depth==0&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(ALCout$DIC_epi/ALCout$Vepi*12~as.POSIXct(ALCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='DIC mg L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=ALCout\ntempntl=ntl[ntl$lakeid=='AL'&ntl$depth<=4&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$DIC_epi/temp$Vepi*12,by=list(temp$month),FUN=mean,na.rm=T)\ntempntl=aggregate(tempntl$dic,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','dic')\ncolnames(tempntl)<-c('month','dic')\n# windows()\nylim=range(temp$dic,tempntl$dic)\nplot(temp$dic~temp$month,pch=16,type='o',ylim=dicYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='DIC (mg L-1)',\n     xlab='')\npoints(tempntl$dic~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$DIC_mod[6]=mean(temp$dic)\nntlMod_Obs$DIC_obs[6]=mean(tempntl$dic)\nntlMod_Obs$DIC_cor[6]=cor(temp$dic[temp$month%in%tempntl$month],tempntl$dic)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(ALCout$datetime)))\nylim=c(0,30)\n# plot(ntlChl$chlor[ntlChl$lakeid=='AL'&ntlChl$depth==0&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2]]~\n#        ntlChl$sampledate[ntlChl$lakeid=='AL'&ntlChl$depth==0&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((ALCout$phyto/50)/(ALCout$Vepi)*12*1000~as.POSIXct(ALCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='Chl-a ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=ALCout\ntempntl=ntlChl[ntlChl$lakeid=='AL'&ntlChl$depth<=2&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$phyto/50)/(temp$Vepi)*12*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$chlor,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','chl')\ncolnames(tempntl)<-c('month','chl')\n# windows()\nylim=range(temp$chl,tempntl$chl)\nplot(temp$chl~temp$month,pch=16,type='o',ylim=chlYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Chl (ug L-1)',\n     xlab='')\npoints(tempntl$chl~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$Chl_mod[6]=mean(temp$chl)\nntlMod_Obs$Chl_obs[6]=mean(tempntl$chl)\nntlMod_Obs$Chl_cor[6]=cor(temp$chl[temp$month%in%tempntl$month],tempntl$chl)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(ALCout$datetime)))\n# plot(ntlTemp$wtemp[ntlTemp$depth==1&ntlTemp$lakeid=='AL']~ntlTemp$sampledate[ntlTemp$depth==1&ntlTemp$lakeid=='AL'],type='l',xlim=xlim,\n#      ylab='Temp C',xlab='',lwd=2,cex.lab=1.5,cex.axis=2,col='grey60')\n# lines(ALCout$epiTemp~as.POSIXct(ALCout$datetime),lwd=2)\n\ntemp=ALCout\ntempntl=ntlTemp[ntlTemp$depth==1&ntlTemp$lakeid=='AL'&!is.na(ntlTemp$wtemp),]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$epiTemp,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$wtemp,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','wtr')\ncolnames(tempntl)<-c('month','wtr')\n# windows()\nylim=range(temp$wtr,tempntl$wtr)\nplot(temp$wtr~temp$month,pch=16,type='o',ylim=wtrYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Epi Temp (deg C)',\n     xlab='')\npoints(tempntl$wtr~tempntl$month,col='grey60',pch=16,type='o',cex=2)\n\nntlMod_Obs$Wtr_mod[6]=mean(temp$wtr)\nntlMod_Obs$Wtr_obs[6]=mean(tempntl$wtr)\nntlMod_Obs$Wtr_cor[6]=cor(temp$wtr[temp$month%in%tempntl$month],tempntl$wtr)\n\n# dev.off()\n# **********************************************************\n\n# TB ****************************************************\n# windows()\n# png('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/TB_validation.png',width=49,height = 7,res=300,units='in')\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(TBCout$datetime)))\nylim=c(2,30)\n# par(mfrow=c(1,7),mar=c(5,6,2,2))\ncex=2\nlwd=2\ncex.axis=2\ncex.lab=2\n# plot(ntl$doc[ntl$lakeid=='TB'&ntl$depth==0&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2]]~ntl$sampledate[ntl$lakeid=='TB'&ntl$depth==0&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((TBCout$DOCr_epi+TBCout$DOCl_epi)/(TBCout$Vepi)*12~as.POSIXct(TBCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='DOC mg L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=TBCout\ntempntl=ntl[ntl$lakeid=='TB'&ntl$depth<=1&!is.na(ntl$doc)&ntl$doc>ylim[1]&ntl$doc<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$DOCr_epi+temp$DOCl_epi)/temp$Vepi*12,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$doc,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','doc')\ncolnames(tempntl)<-c('month','doc')\n# windows()\nylim=range(temp$doc,tempntl$doc)\nplot(temp$doc~temp$month,pch=16,type='o',ylim=docYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='DOC (mg L-1)',\n     xlab='')\npoints(tempntl$doc~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$lakeID[7]='TB'\nntlMod_Obs$DOC_mod[7]=mean(temp$doc)\nntlMod_Obs$DOC_obs[7]=mean(tempntl$doc)\nntlMod_Obs$DOC_cor[7]=cor(temp$doc[temp$month%in%tempntl$month],tempntl$doc)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(TBCout$datetime)))\nylim=c(0,50)\n# plot(ntl$totpf[ntl$lakeid=='TB'&ntl$depth==0&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='TB'&ntl$depth==0&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(TBCout$P_epi/(TBCout$Vepi)*31*1000~as.POSIXct(TBCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='SRP ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=TBCout\ntempntl=ntl[ntl$lakeid=='TB'&ntl$depth<=1&!is.na(ntl$totpf)&ntl$totpf>ylim[1]&ntl$totpf<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$P_epi/(temp$Vepi)*31*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$totpf,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','srp')\ncolnames(tempntl)<-c('month','srp')\n# windows()\nylim=range(temp$srp,tempntl$srp)\nplot(temp$srp~temp$month,pch=16,type='o',ylim=srpYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='SRP (ug L-1)',\n     xlab='')\npoints(tempntl$srp~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$SRP_mod[7]=mean(temp$srp)\nntlMod_Obs$SRP_obs[7]=mean(tempntl$srp)\nntlMod_Obs$SRP_cor[7]=cor(temp$srp[temp$month%in%tempntl$month],tempntl$srp)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(TBCout$datetime)))\nylim=c(0,50)\n# plot(ntl$totpuf[ntl$lakeid=='TB'&ntl$depth==0&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='TB'&ntl$depth==0&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((TBCout$P_epi+TBCout$phyto/95)/(TBCout$Vepi)*31*1000~as.POSIXct(TBCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='TP ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=TBCout\ntempntl=ntl[ntl$lakeid=='TB'&ntl$depth<=1&!is.na(ntl$totpuf)&ntl$totpuf>ylim[1]&ntl$totpuf<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$P_epi+temp$phyto/95)/(temp$Vepi)*31*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$totpuf,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','tp')\ncolnames(tempntl)<-c('month','tp')\n# windows()\nylim=range(temp$tp,tempntl$tp)\nplot(temp$tp~temp$month,pch=16,type='o',ylim=tpYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='TP (ug L-1)',\n     xlab='')\npoints(tempntl$tp~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$TP_mod[7]=mean(temp$tp)\nntlMod_Obs$TP_obs[7]=mean(tempntl$tp)\nntlMod_Obs$TP_cor[7]=cor(temp$tp[temp$month%in%tempntl$month],tempntl$tp)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(TBCout$datetime)))\nylim=c(3,10)\n# plot(ntl$ph[ntl$lakeid=='TB'&ntl$depth==0&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='TB'&ntl$depth==0&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(TBCout$pH~as.POSIXct(TBCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='pH',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=TBCout\ntempntl=ntl[ntl$lakeid=='TB'&ntl$depth<=4&!is.na(ntl$ph)&ntl$ph>ylim[1]&ntl$ph<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$pH,by=list(temp$month),FUN=mean,na.rm=T)\ntempntl=aggregate(tempntl$ph,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','pH')\ncolnames(tempntl)<-c('month','pH')\n# windows()\nylim=range(temp$pH,tempntl$pH)\nplot(temp$pH~temp$month,pch=16,type='o',ylim=phYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='pH',\n     xlab='')\npoints(tempntl$pH~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$pH_mod[7]=mean(temp$pH)\nntlMod_Obs$pH_obs[7]=mean(tempntl$pH)\nntlMod_Obs$pH_cor[7]=cor(temp$pH[temp$month%in%tempntl$month],tempntl$pH)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(TBCout$datetime)))\nylim=c(0,20)\n# plot(ntl$dic[ntl$lakeid=='TB'&ntl$depth==0&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2]]~\n#        ntl$sampledate[ntl$lakeid=='TB'&ntl$depth==0&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot(TBCout$DIC_epi/TBCout$Vepi*12~as.POSIXct(TBCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='DIC mg L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=TBCout\ntempntl=ntl[ntl$lakeid=='TB'&ntl$depth<=4&!is.na(ntl$dic)&ntl$dic>ylim[1]&ntl$dic<ylim[2]&ntl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$DIC_epi/temp$Vepi*12,by=list(temp$month),FUN=mean,na.rm=T)\ntempntl=aggregate(tempntl$dic,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','dic')\ncolnames(tempntl)<-c('month','dic')\n# windows()\nylim=range(temp$dic,tempntl$dic)\nplot(temp$dic~temp$month,pch=16,type='o',ylim=dicYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='DIC (mg L-1)',\n     xlab='')\npoints(tempntl$dic~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$DIC_mod[7]=mean(temp$dic)\nntlMod_Obs$DIC_obs[7]=mean(tempntl$dic)\nntlMod_Obs$DIC_cor[7]=cor(temp$dic[temp$month%in%tempntl$month],tempntl$dic)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(TBCout$datetime)))\nylim=c(0,30)\n# plot(ntlChl$chlor[ntlChl$lakeid=='TB'&ntlChl$depth==0&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2]]~\n#        ntlChl$sampledate[ntlChl$lakeid=='TB'&ntlChl$depth==0&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2]],\n#      col='grey60',xlim=xlim,ylim=ylim,pch=16,lwd=3,ylab='',xlab='',yaxt='n',xaxt='n',type='o',cex.lab=1.5)\n# par(new=T)\n# plot((TBCout$phyto/50)/(TBCout$Vepi)*12*1000~as.POSIXct(TBCout$datetime,format='%Y-%m-%d'),cex.lab=1.5,xlim=xlim,ylim=ylim,ylab='Chl-a ug L-1',type='l',lwd=4,xlab='Date',cex.axis=2,xaxt='n')\n# axis(1,at=c(as.POSIXct('1990-01-01'),as.POSIXct('2005-01-01'),as.POSIXct('2010-01-01')),labels = c(1990,2005,2010),cex.axis=2)\n# legend('topleft',legend = c('Modeled','Observed'),fill = c('black','grey60'),bty='n')\n\ntemp=TBCout\ntempntl=ntlChl[ntlChl$lakeid=='TB'&ntlChl$depth<=2&!is.na(ntlChl$chlor)&ntlChl$chlor>ylim[1]&ntlChl$chlor<ylim[2]&ntlChl$sampledate<xlim[2],]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate((temp$phyto/50)/(temp$Vepi)*12*1000,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$chlor,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','chl')\ncolnames(tempntl)<-c('month','chl')\n# windows()\nylim=range(temp$chl,tempntl$chl)\nplot(temp$chl~temp$month,pch=16,type='o',ylim=chlYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Chl (ug L-1)',\n     xlab='')\npoints(tempntl$chl~tempntl$month,col='grey60',pch=16,type='o',cex=cex,lwd=lwd)\n\nntlMod_Obs$Chl_mod[7]=mean(temp$chl)\nntlMod_Obs$Chl_obs[7]=mean(tempntl$chl)\nntlMod_Obs$Chl_cor[7]=cor(temp$chl[temp$month%in%tempntl$month],tempntl$chl)\n\n# windows()\n# xlim=c(as.POSIXct('1987-01-01 00:00:00'),max(as.POSIXct(TBCout$datetime)))\n# plot(ntlTemp$wtemp[ntlTemp$depth==1&ntlTemp$lakeid=='TB']~ntlTemp$sampledate[ntlTemp$depth==1&ntlTemp$lakeid=='TB'],type='l',xlim=xlim,\n#      ylab='Temp C',xlab='',lwd=2,cex.lab=1.5,cex.axis=2,col='grey60')\n# lines(TBCout$epiTemp~as.POSIXct(TBCout$datetime),lwd=2)\n\ntemp=TBCout\ntempntl=ntlTemp[ntlTemp$depth<=1&ntlTemp$lakeid=='TB'&!is.na(ntlTemp$wtemp),]\ntemp$month<-strftime(strptime(temp$datetime,'%Y-%m-%d'),'%m')\ntempntl$month<-strftime(strptime(tempntl$sampledate,'%Y-%m-%d'),'%m')\ntemp=aggregate(temp$epiTemp,by=list(temp$month),FUN=mean)\ntempntl=aggregate(tempntl$wtemp,by=list(tempntl$month),FUN=mean)\ncolnames(temp)<-c('month','wtr')\ncolnames(tempntl)<-c('month','wtr')\n# windows()\nylim=range(temp$wtr,tempntl$wtr)\nplot(temp$wtr~temp$month,pch=16,type='o',ylim=wtrYlim,cex=cex,lwd=lwd,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Epi Temp (deg C)',\n     xlab='')\npoints(tempntl$wtr~tempntl$month,col='grey60',pch=16,type='o',cex=2)\n\nntlMod_Obs$Wtr_mod[7]=mean(temp$wtr)\nntlMod_Obs$Wtr_obs[7]=mean(tempntl$wtr)\nntlMod_Obs$Wtr_cor[7]=cor(temp$wtr[temp$month%in%tempntl$month],tempntl$wtr)\n\n# windows()\n# ylim=range(ntlMod_Obs$DOC_obs,ntlMod_Obs$DOC_mod)\n# plot(ntlMod_Obs$DOC_obs~ntlMod_Obs$DOC_mod,pch=16,cex=cex,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Obs DOC (mg L-1)',\n#      xlab='Mod DOC (mg L-1)',ylim=ylim,xlim=ylim)\n# abline(0,1,lty=2,lwd=lwd)\n# ylim=range(ntlMod_Obs$SRP_mod,ntlMod_Obs$SRP_obs)\n# plot(ntlMod_Obs$SRP_obs~ntlMod_Obs$SRP_mod,pch=16,cex=cex,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Obs SRP (ug L-1)',\n#      xlab='Mod SRP (ug L-1)',ylim=ylim,xlim=ylim)\n# abline(0,1,lty=2,lwd=lwd)\n# ylim=range(ntlMod_Obs$TP_mod,ntlMod_Obs$TP_obs)\n# plot(ntlMod_Obs$TP_obs~ntlMod_Obs$TP_mod,pch=16,cex=cex,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Obs TP (ug L-1)',\n#      xlab='Mod TP (ug L-1)',ylim=ylim,xlim=ylim)\n# abline(0,1,lty=2,lwd=lwd)\n# ylim=range(ntlMod_Obs$pH_obs,ntlMod_Obs$pH_mod)\n# plot(ntlMod_Obs$pH_obs~ntlMod_Obs$pH_mod,pch=16,cex=cex,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Obs pH',\n#      xlab='Mod pH',ylim=ylim,xlim=ylim)\n# abline(0,1,lty=2,lwd=lwd)\n# ylim=range(ntlMod_Obs$DIC_mod,ntlMod_Obs$DIC_obs)\n# plot(ntlMod_Obs$DIC_obs~ntlMod_Obs$DIC_mod,pch=16,cex=cex,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Obs DIC (mg L-1)',\n#      xlab='Mod DIC (mg L-1)',ylim=ylim,xlim=ylim)\n# abline(0,1,lty=2,lwd=lwd)\n# ylim=range(ntlMod_Obs$Chl_mod,ntlMod_Obs$Chl_obs)\n# plot(ntlMod_Obs$Chl_obs~ntlMod_Obs$Chl_mod,pch=16,cex=cex,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Obs Chl (ug L-1)',\n#      xlab='Mod Chl (ug L-1)',ylim=ylim,xlim=ylim)\n# abline(0,1,lty=2,lwd=lwd)\n# ylim=range(ntlMod_Obs$Wtr_mod,ntlMod_Obs$Wtr_obs)\n# plot(ntlMod_Obs$Wtr_obs~ntlMod_Obs$Wtr_mod,pch=16,cex=cex,cex.axis=cex.axis,cex.lab=cex.lab,ylab='Obs Wtr (deg C)',\n#      xlab='Mod Wtr (deg C)',ylim=ylim,xlim=ylim)\n# abline(0,1,lty=2,lwd=lwd)\n\ndev.off()\n# **********************************************************\n#########################################################################\n\nsummary(lm(ntlMod_Obs$DOC_obs~ntlMod_Obs$DOC_mod))\nsummary(lm(ntlMod_Obs$SRP_obs~ntlMod_Obs$SRP_mod))\nsummary(lm(ntlMod_Obs$TP_obs~ntlMod_Obs$TP_mod))\nsummary(lm(ntlMod_Obs$pH_obs~ntlMod_Obs$pH_mod))\nsummary(lm(ntlMod_Obs$DIC_obs~ntlMod_Obs$DIC_mod))\nsummary(lm(ntlMod_Obs$Wtr_obs~ntlMod_Obs$Wtr_mod))\n\n\n# **********************************************************\n\n# comparing to Cole et al. 2007 estimates \n# 1.1e14 Pg C emitted / year; 4.2 million km2 lake surface area = 26.2 g C m-2 year-1 = 95 mg C m-2 day-1; 1.1e14 Pg C emitted / year; \n# 0.9e14 Pg C emitted / year; 4.2 million km2 lake surface area \ncoleEmit=0.11e15/(4200000*1000*1000) # average emit g C m-2 yr-1 => could use Raymond's lake area (using Downing's lake area - not clear what they used in Cole et al. 2007)\ncoleBury=0.05e15/(4200000*1000*1000) # average burial mg C m-2 day-1\n\nresArea=400000*1000*1000 # km2 converted to m2\ncoleEmitRes=0.28e15/resArea\ncoleBuryRes=0.18e15/resArea\n\n\nraymondEmit=.322e15/(3001009*1000*1000) # average emit from Raymond et al 2013 (see supplementary for lake size bins)\n\n# atmCO2=1*390/1e6/29.41*1000 # atm equil in mol C m-3\n# raymond0.1<-1*1303/1e6/29.41*1000\n# raymond1<-1*1135/1e6/29.41*1000\n# raymond10<-1*966/1e6/29.41*1000\n# raymond100<-1*818/1e6/29.41*1000\n\n# emit0.1=0.57*(raymond0.1-atmCO2)*211551*1000*1000*365*12 # I don't think this is right, but it's close \n# emit1=0.80*(raymond1-atmCO2)*212233*1000*1000*365*12 # I don't think this is right, but it's close \n# emit10=0.85*(raymond10-atmCO2)*370262*1000*1000*365*12 # I don't think this is right, but it's close \n# emit100=1.09*(raymond100-atmCO2)*402597*1000*1000*365*12 # I don't think this is right, but it's close \n# \n# (emit100+emit10+emit0.1+emit1)/1e15\n\nraymondEmit0.1=0.027/211551/1000/1000*1e15 # g C m-2 yr-1; dividing Raymonds total emissions by lake surface area by class to get an average emissions per lake class \nraymondEmit1=0.032/212233/1000/1000*1e15\nraymondEmit10=0.048/370262/1000/1000*1e15\nraymondEmit100=0.050/402597/1000/1000*1e15\n\nraymondEmitNHLD=raymondEmit0.1*sum(sum$Area[sum$Area<=1e5])+raymondEmit1*sum(sum$Area[sum$Area>1e5&sum$Area<=1e6])+\n  raymondEmit10*sum(sum$Area[sum$Area>1e6&sum$Area<=1e7])+raymondEmit100*sum(sum$Area[sum$Area>1e7]) # g C yr-1 \n\nsum$epi_CO2=sum$fracCO2*sum$DIC_epi/sum$Vepi # mol C m-3 as CO2 \nall$epi_CO2=all$fracCO2*all$DIC_epi/all$Vepi # mol C m-3 as CO2 - don't use this for scaling because super high co2 during winter \n\n# sum$epi_CO2 # \nNHLDresArea=22281214\nNHLDlakeArea=777575138\n\ncoleNHLDemit=coleEmit*NHLDlakeArea # C emit / day with Cole estimates \ncoleNHLDbury=coleBury*NHLDlakeArea # C burial / day with Cole estimates \ncoleNHLDemitRes=coleEmitRes*NHLDresArea\ncoleNHLDburyRes=coleBuryRes*NHLDresArea\n# raymondNHLDemit=raymondEmit*(sum(sum$Area)) \n\nsum$HRT<-sum$Vol/(sum$GWin+sum$SWin+sum$DirectP+sum$Baseflow)\nsum$percentEvap<-sum$LakeE/(sum$LakeE+sum$GWout+sum$SWout)\nsummary(sum$percentEvap)\n\nndNHLDemit=sum(sum$Emit*12*365) # g C yr-1 \nndNHLDbury=sum(sum$Burial_phyto*12*365,sum$Burial_tPOC*12*365) # g C yr-1 \n\nndOpenIceEmit=ndNHLDemit\nndOpenIceBurial=ndNHLDbury\n\n\nndNHLDemitSmallLakes=sum(sum$Emit[sum$Area<10000]*12*365)\nndNHLDburySmallLakes=sum(sum$Burial_phyto[sum$Area<10000]*12*365,sum$Burial_tPOC[sum$Area<10000]*12*365)\n\nndNHLDemitLargeLakes=sum(sum$Emit[sum$Area>10000]*12*365)\nndNHLDburyLargeLakes=sum(sum$Burial_phyto[sum$Area>10000]*12*365,sum$Burial_tPOC[sum$Area>10000]*12*365)\n\nsum(sum$Area[sum$Area>220000])/sum(sum$Area) # 22 ha is average lake area for NHLD \n\nsummary(sum$HRT)\n\nndNHLDemitlowHRT=sum(sum$Emit[sum$HRT<545]*12*365) # 545 days is median \nndNHLDemitlongHRT=sum(sum$Emit[sum$HRT>545]*12*365)\n\nndNHLDemitlowPercE=sum(sum$Emit[sum$percentEvap<.705]*12*365) # 0.705 is median \nndNHLDemithighPercE=sum(sum$Emit[sum$percentEvap>.705]*12*365)\n\nndNHLDemitlowHRT/ndNHLDemit\nndNHLDemitlongHRT/ndNHLDemit\n\nndNHLDburyLargeLakes/ndNHLDbury\nndNHLDemitLargeLakes/ndNHLDemit\n\nndNHLDemitlowPercE/ndNHLDemit\nndNHLDemithighPercE/ndNHLDemit\n\nndNHLDemit/coleNHLDemit\nndNHLDbury/coleNHLDbury\n\nndNHLDemit/raymondEmitNHLD\n\nndNHLDemit/1e9 # Gigagrams of C per year \nndNHLDbury/1e9\ncoleNHLDemit/1e9\ncoleNHLDbury/1e9\nraymondEmitNHLD/1e9\n\nndNHLDemitSmallLakes/sum(sum$Area[sum$Area<10000]) # average areal rate small lakes \nndNHLDemitLargeLakes/sum(sum$Area[sum$Area>10000]) # average areal rate large lakes \nndNHLDemit/sum(sum$Area)\n\nndNHLDburySmallLakes/sum(sum$Area[sum$Area<10000]) # average areal rate small lakes \nndNHLDburyLargeLakes/sum(sum$Area[sum$Area>10000]) # average areal rate large lakes \nndNHLDbury/sum(sum$Area)\n\nndNHLDemitlowPercE/sum(sum$Area[sum$percentEvap<.63])\nndNHLDemithighPercE/sum(sum$Area[sum$percentEvap>.63])\n\nmean(sum$Emit[sum$Area<10000]/sum$Area[sum$Area<10000]*12*365)\nmean(sum$Emit[sum$Area>10000]/sum$Area[sum$Area>10000]*12*365)\n\n# average turnover rate of C \nsum$emergent_d20=sum$DOCl_epi/(sum$DOCl_epi+sum$DOCr_epi)*0.08+sum$DOCr_epi/(sum$DOCl_epi+sum$DOCr_epi)*0.002\n\n\nwindows()\nplot(sum$emergent_d20~sum$HRT,pch=16,cex=1,cex.lab=1.5,cex.axis=2,ylab='Emergent d20 (day-1)',xlab='HRT (days)')\n\nwindows()\nplot(log10((sum$Emit/sum$Area*12*1000))~sum$percentEvap,yaxt='n')\naxis(2,at = c(log10(10),log10(100),log10(1000)),labels = c(10,100,1000))\nplot(log10(sum$Emit/sum$Area*12*1000)~log10(sum$HRT),yaxt='n')\naxis(2,at = c(log10(10),log10(100),log10(1000)),labels = c(10,100,1000))\n\nplot(log10(sum$HRT)~log10(sum$Area),yaxt='n')\naxis(2,at = c(log10(10),log10(100),log10(1000)),labels = c(10,100,1000))\n\nplot(sum$pH~log10(sum$Area))\npoints(hanson$pH~log10(hanson$area),col='red',pch=16)\n\n\n# comparing if using entire year - including ice cover \n\n\ncoleNHLDemit=coleEmit*(sum(all$Area)) # C emit / day with Cole estimates \ncoleNHLDbury=coleBury*(sum(all$Area)) # C burial / day with Cole estimates \nraymondEmitNHLD=raymondEmit0.1*sum(all$Area[all$Area<=1e5])+raymondEmit1*sum(all$Area[all$Area>1e5&all$Area<=1e6])+\n  raymondEmit10*sum(all$Area[all$Area>1e6&all$Area<=1e7])+raymondEmit100*sum(all$Area[all$Area>1e7]) # g C yr-1 \n\nsummary(all$percentEvap)\n\nndNHLDemit=sum(all$Emit*12*365)\nndNHLDbury=sum(all$Burial_phyto*12*365,all$Burial_tPOC*12*365)\n\nndAnnualEmit=ndNHLDemit\nndAnnualBurial=ndNHLDbury\n\nndNHLDemitSmallLakes=sum(all$Emit[all$Area<10000]*12*365)\nndNHLDburySmallLakes=sum(all$Burial_phyto[all$Area<10000]*12*365,all$Burial_tPOC[all$Area<10000]*12*365)\n\nndNHLDemitLargeLakes=sum(all$Emit[all$Area>10000]*12*365)\nndNHLDburyLargeLakes=sum(all$Burial_phyto[all$Area>10000]*12*365,all$Burial_tPOC[all$Area>10000]*12*365)\n\nsum(all$Area[all$Area>220000])/sum(all$Area) # 22 ha is average lake area for NHLD \n\nsummary(all$HRT)\n\nndNHLDemitlowHRT=sum(all$Emit[all$HRT<400]*12*365)\nndNHLDemitlongHRT=sum(all$Emit[all$HRT>400]*12*365)\n\nndNHLDemitlowPercE=sum(all$Emit[all$percentEvap<.63]*12*365)\nndNHLDemithighPercE=sum(all$Emit[all$percentEvap>.63]*12*365)\n\nndNHLDemitlowHRT/ndNHLDemit\nndNHLDemitlongHRT/ndNHLDemit\n\nndNHLDburyLargeLakes/ndNHLDbury\nndNHLDemitLargeLakes/ndNHLDemit\n\nndNHLDemitlowPercE/ndNHLDemit\nndNHLDemithighPercE/ndNHLDemit\n\nndNHLDemit/coleNHLDemit\nndNHLDbury/coleNHLDbury\n\nndNHLDemit/raymondEmitNHLD\n\nndNHLDemit/1e9 # Gigagrams of C per year \nndNHLDbury/1e9\ncoleNHLDemit/1e9\ncoleNHLDbury/1e9\nraymondEmitNHLD/1e9\n\n(coleNHLDemitRes+coleNHLDemit)/1e9\n(coleNHLDburyRes+coleNHLDbury)/1e9\n\n# total fluxes Gg C yr-1 \nndAnnualEmit=ndAnnualEmit/1e9\nndAnnualBurial=ndAnnualBurial/1e9\nndOpenIceEmit=ndOpenIceEmit/1e9\nndOpenIceBurial=ndOpenIceBurial/1e9\ncoleEmit=21\ncoleBury=9.55\ncoleEmitRes=35.96\ncoleBuryRes=19.28\nraymondEmit=106.6\n\n# fraction of carbon retained in NHLD \nsum(all$FracRet*all$Area)/sum(all$Area)\n\nallFlux=c(ndAnnualEmit,ndAnnualBurial,ndOpenIceEmit,ndOpenIceBurial,coleEmit,coleBury,coleEmitRes,\n          coleBuryRes,raymondEmit)\n\nwindows()\npng('/Users/Jake/Documents/Jake/MyPapers/Regional Lake Carbon Model - ECI/Figures/fig7_annualEmit_burial.png',\n    width = 7,height = 7,units='in',res = 300)\nbp.at=c(0,0,1,0,1,0,1,0,1)\npar(mar=c(6,6,5,4))\nbarplot(allFlux,space = bp.at,col=c('gray80','gray20'),border = 'black',lwd=2,cex.axis = 2,cex.lab=2,ylab='Carbon Flux (Gg C yr-1)')\nlegend('topleft',legend = c('Emissions','Burial'),col = c('gray80','gray20'),bty = 'n',fill = c('gray80','gray20'),cex=2)\ndev.off()\n\n\n",
    "created" : 1505235934617.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1790823454",
    "id" : "D9CB50BD",
    "lastKnownWriteTime" : 1505235887,
    "last_content_update" : 1505235887,
    "path" : "C:/Users/jzwart/NHLD_C_Model/R_Code/NHLDCsummary_20170828.R",
    "project_path" : "R_Code/NHLDCsummary_20170828.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}